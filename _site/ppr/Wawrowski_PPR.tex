% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\title{Podstawy programowania R}
\author{Łukasz Wawrowski}
\date{}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Podstawy programowania R},
  pdfauthor={Łukasz Wawrowski},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{wprowadzenie}{%
\chapter*{Wprowadzenie}\label{wprowadzenie}}
\addcontentsline{toc}{chapter}{Wprowadzenie}

Polecana literatura:

\begin{itemize}
\item
  Garret Grolemund, Hadley Wickham - \href{http://r4ds.had.co.nz/}{\emph{R for Data Science}} (\href{https://helion.pl/ksiazki/jezyk-r-kompletny-zestaw-narzedzi-dla-analitykow-danych-hadley-wickham-garrett-grolemund,jezrko.htm}{polska wersja})
\item
  Marek Gągolewski - \href{http://www.gagolewski.com/publications/programowanier/}{\emph{Programowanie w języku R. Analiza danych, obliczenia, symulacje.}}
\end{itemize}

\href{https://github.com/lwawrowski/cdv_bigdata}{Skrypty z zajęć}

\hypertarget{wprowadzenie-do-r}{%
\chapter{Wprowadzenie do R}\label{wprowadzenie-do-r}}

\href{presentations/01_wprowadzenie.html}{Prezentacja}

\hypertarget{wprowadzenie-1}{%
\section{Wprowadzenie}\label{wprowadzenie-1}}

GNU R to interpretowany język programowania oraz środowisko do obliczeń statystycznych i wizualizacji wyników {[}Wikipedia 2017{]}.

Robert A. Muenchen - \href{http://r4stats.com/articles/popularity/}{The Popularity of Data Science Software}

\includegraphics{img/pop_r1.png}

\hypertarget{r}{%
\section{R}\label{r}}

Bazowa wersja R jest do pobrania ze strony \href{https://cloud.r-project.org/}{r-project.org}.

\includegraphics{img/r.png}

\hypertarget{rstudio}{%
\section{RStudio}\label{rstudio}}

RStudio to zintegrowane środowisko programistyczne (IDE) dla języka R dostępne za darmo na stronie \href{https://www.rstudio.com/products/rstudio/download/}{RStudio}.

\includegraphics{img/rstudio.png}

Z R można także korzystać w \href{https://www.visualstudio.com/pl/vs/rtvs/}{Microsoft Visual Studio}.

\hypertarget{waux17cne-informacje}{%
\section{Ważne informacje}\label{waux17cne-informacje}}

\textbf{R jest wrażliwy na wielkość liter.}

\textbf{Separatorem części dziesiętnej liczby jest kropka.}

\textbf{W codziennej pracy RStudio jest wygodniejsze, jednak długotrwałe obliczenia lepiej uruchamiać w trybie wsadowym w zwykłym R.}

\begin{itemize}
\tightlist
\item
  \textbf{Katalog roboczy}
\end{itemize}

Ważnym pojęciem w R jest katalog roboczy (ang. working directory), który określa gdzie zostaną zapisane pliki, wykresy, zbiory, itp. jeśli nie podamy dokładnej ścieżki do pliku. Katalog roboczy przypisuje się z wykorzystaniem funkcji \texttt{setwd("ścieżka\ do\ katalogu")}, a jego wartość można sprawdzić funkcją \texttt{getwd()}. W RStudio przypisanie katalogu roboczego odbywa się w momencie utworzenia projektu.

\begin{itemize}
\tightlist
\item
  \textbf{Projekt}
\end{itemize}

Katalog na dysku, w którym znajdują się wszystkie pliki projektu wraz z plikiem o rozszerzeniu .Rproj skojarzonym z RStudio.

\begin{itemize}
\tightlist
\item
  \textbf{Korzystanie z pomocy}
\end{itemize}

Dostęp do pomocy odnośnie wybranej funkcji można uzyskać na dwa sposoby. Pierwszym z nich jest poprzedzenie nazwy funkcji w konsoli znakiem zapytania np. \texttt{?getwd} lub wywołanie funkcji help na nazwie funkcji \texttt{help("getwd")}. Drugim sposobem jest umieszczenie kursora w dowolnym miejscu nazwy funkcji i wciśnięcie klawisza F1.

Internet - przede wszystkim \href{https://stackoverflow.com/questions/tagged/r}{stackoverflow}.

\begin{itemize}
\tightlist
\item
  \textbf{Komentarze}
\end{itemize}

\begin{quote}
Real programmers don't comment their code. If it was hard to write it should be hard to understand.
\end{quote}

Dobrze napisany kod jest czytelny bez komentarzy. W R komentarze rozpoczynają się od symbolu \#. Skrót klawiaturowy w RStudio to CTRL + SHIFT + C (do wstawiania i usuwania komentarzy).

\begin{itemize}
\tightlist
\item
  \textbf{Podpowiadanie składni}
\end{itemize}

RStudio ma zaimplementowaną funkcję podpowiadania składni. Listę możliwych funkcji i obiektów wywołuję się klawiszem TAB lub CTRL + SPACJA po wpisaniu co najmniej jednej litery. Kolejne naciśnięcie TAB lub ENTER powoduje uzupełnienie kodu o wybraną funkcję lub obiekt.

\begin{itemize}
\tightlist
\item
  \textbf{Wykonywanie programów}
\end{itemize}

Programy w R możemy tworzyć jako skrypty w pliku tekstowym o rozszerzeniu .R lub wywoływać polecenia bezpośrednio w konsoli. Kod programu napisanego w skrypcie przekazywany jest do konsoli. Gotowość do pracy R sygnalizuje w konsoli znakiem zachęty \texttt{\textgreater{}}. Jeśli podczas wykonywania programu w konsoli pojawi się znak \texttt{+} to oznacza oczekiwanie na kompletny kod - brak domkniętego nawiasu, cudzysłowia, itp.:

\begin{verbatim}
> getwd(
+ 
\end{verbatim}

W powyższym przykładzie brakuje prawego nawiasu. Dodanie brakującego kodu spowoduje wykonanie przekazanego polecenia. Z kolei wciśnięcie klawisza ESC spowoduje przerwanie wykonywanie programu i powrót do znaku zachęty. Zawartość konsoli można wyczyścić stosując kombinację klawiszy CTRL + L.

\begin{itemize}
\tightlist
\item
  \textbf{Pliki }
\end{itemize}

Jeśli w pamięci znajdują się jakieś obiekty (zakładka Environment) to RStudio przy zamykaniu programu zapyta o zapisanie tych obiektów do pliku .RData. Jeżeli zdecydujemy się na tą propozycję to po ponownym uruchomieniu projektu obiekty znajdujące się w pliku .RData zostaną automatycznie wczytane do pamięci.

Można także samodzielnie tworzyć pliki o rozszerzeniu .RData z wykorzystaniem funkcji \texttt{save()}:

\begin{verbatim}
save(obiekt1, obiekt2, obiekt3, file = "nazwa_pliku.RData")
\end{verbatim}

Wczytanie obiektów z takiego pliku do pamięci odbywa się z zastosowaniem funkcji \texttt{load()}:

\begin{verbatim}
load("nazwa_pliku.RData")
\end{verbatim}

\hypertarget{pakiety}{%
\section{Pakiety}\label{pakiety}}

Podstawowe możliwości R są dosyć ograniczone. Rozszerzają je pakiety, których obecnie jest ponad 12 tysięcy. Można je przeglądać według kategorii w \href{https://cran.r-project.org/web/views/}{CRAN Task Views} lub w wygodnej wyszukiwarce \href{https://www.r-pkg.org/}{METACRAN} i \href{https://rdrr.io/}{rdrr.io}.

\hypertarget{r-jako-kalkulator}{%
\section{R jako kalkulator}\label{r-jako-kalkulator}}

Działania matematycznie w R:

\begin{longtable}[]{@{}cc@{}}
\toprule
Operator & Operacja \\
\midrule
\endhead
+ & dodawanie \\
- & odejmowanie \\
* & mnożenie \\
/ & dzielenie \\
\^{} lub ** & potęgowanie \\
sqrt() & pierwiastkowanie \\
\bottomrule
\end{longtable}

W R istnieje także stała wbudowana \texttt{pi} przechowująca wartość liczby pi.

Funkcja \texttt{factorial(x)} zwraca silnię (znak wykrzyknika !) z podanej wartości x, a \texttt{sign(x)} sprawdza znak wyrażenia i zwraca odpowiednio wartość -1 jeśli wyrażenie jest ujemne, 0 jeśli jest równe 0 i 1 dla wyrażeń dodatnich.

Funkcja \texttt{exp(x)} zwraca wartość wyrażenia \(e^x\), natomiast funkcja \texttt{log(x)} zwraca logarytm z podanej liczby. Domyślnie jest to logarytm naturalny, ale można zmienić podstawę podając wartość argumentu \texttt{base}.

Funkcja \texttt{abs(x)} zwraca wartość bezwzględną (absolutną) wyrażenia.

\textbf{Ćwiczenie}

Oblicz wartość wyrażenia: \(2\cdot \sqrt{\pi} + log_28\).

Rozwiązanie:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{*}\FunctionTok{sqrt}\NormalTok{(pi)}\SpecialCharTok{+}\FunctionTok{log}\NormalTok{(}\DecValTok{8}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6.544908
\end{verbatim}

\textbf{Zadania}

Oblicz wartość wyrażeń:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(\frac{2^3\cdot6^2}{(\frac{1}{2})^2\cdot(\frac{4}{5})^3}\)
\item
  \(\sqrt[3]{\frac{6-3.5}{2^{11}}}\)
\item
  \(\pi+\sqrt{e^4}\)
\item
  \(5! - log_{10}100\)
\item
  \(|1-e|\)
\end{enumerate}

\hypertarget{struktury-danych}{%
\chapter{Struktury danych}\label{struktury-danych}}

\href{presentations/01a_typy_danych.html}{Prezentacja}

\hypertarget{obiekty}{%
\section{Obiekty}\label{obiekty}}

W R praktycznie wszystko jest obiektem. Może to być zbiór danych, ale także wykres czy mapa. Zasadnicza różnica to klasa tych obiektów i operacje jakie mogą być na nich wykonywane.

Funkcje w R wymagają jako argumentów określonych typów obiektów - stąd tak ważna jak znajomość istniejących struktur.

Każdy obiekt w R możemy przypisać do tzw. obiektu nazwanego. Wówczas jest przechowywany w pamięci i można się do niego odwołać. Przypisanie odbywa się za pomocą operatora \texttt{\textless{}-}.

\begin{verbatim}
nazwa <- obiekt
obiekt -> nazwa
\end{verbatim}

Można także przypisywać obiekty z wykorzystaniem znaku równości \texttt{=}, ale nie jest to zalecane ponieważ symbol ten jest używany w innych miejscach np. do deklarowania wartości argumentów w funkcji.

W R dostępna jest funkcja \texttt{assign}, która także umożliwia przypisanie nazwy do obiektu:

\begin{verbatim}
assign("nazwa", obiekt)
\end{verbatim}

\hypertarget{wektor}{%
\section{Wektor}\label{wektor}}

Wektor jest najprostszym typem danych w R. Najczęściej korzysta się z trzech typów wektorów:

\begin{itemize}
\tightlist
\item
  logicznych
\item
  liczbowych
\item
  tekstowych
\end{itemize}

Wektor tworzy się z wykorzystaniem funkcji \texttt{c()}.

\hypertarget{wektor-wartoux15bci-logicznych}{%
\subsection{Wektor wartości logicznych}\label{wektor-wartoux15bci-logicznych}}

Przyjmuje wartości \emph{prawda} lub \emph{fałsz}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE FALSE FALSE
\end{verbatim}

lub w skróconej wersji:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(T, F, F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE FALSE FALSE
\end{verbatim}

Do sprawdzenia długości wektora używa się funkcji \texttt{length}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\FunctionTok{c}\NormalTok{(T, F, F))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3
\end{verbatim}

lub korzystając z obiektu nazwanego:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wart\_log }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(T,F,F)}
\FunctionTok{length}\NormalTok{(wart\_log)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3
\end{verbatim}

Wektory można także utworzyć poprzez replikację określonej wartości lub wektora z wykorzystaniem funkcji \texttt{rep}. Funkcja ta przyjmuje co najmniej dwa argumenty: obowiązkowo \texttt{x} - wektor wejściowy oraz jeden z następujących: \texttt{times} - liczba powtórzeń elementów wektora \texttt{x}, \texttt{each} - liczba powtórzeń elementów wektora \texttt{x} (wyjaśnienie różnicy poniżej) lub \texttt{length.out} - oczekiwana długość wektora wynikowego.

Trzy równoważne zapisy:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(T,F), }\AttributeTok{times =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(T,F), }\AttributeTok{times =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(T,F), }\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE
\end{verbatim}

A tak to wygląda z argumentem \texttt{each}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(T,F), }\AttributeTok{each =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE
\end{verbatim}

Wykorzystanie argumentu \texttt{length.out}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(T,F), }\AttributeTok{length.out =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE FALSE  TRUE FALSE  TRUE
\end{verbatim}

\hypertarget{wektor-wartoux15bci-liczbowych}{%
\subsection{Wektor wartości liczbowych}\label{wektor-wartoux15bci-liczbowych}}

W wektorze możemy przechowywać także liczby:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{, }\FloatTok{2.5}\NormalTok{, .}\DecValTok{6}\NormalTok{) }\CommentTok{\# nie trzeba pisać zera przed ułamkiem}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  1.0  3.0 -5.0  2.5  0.6
\end{verbatim}

Połączenie dwóch wektorów to także wektor:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\FloatTok{3.5}\NormalTok{,}\DecValTok{4}\NormalTok{,}\FloatTok{4.5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.0 2.0 3.0 3.5 4.0 4.5
\end{verbatim}

Pojedyncza liczba też jest jednoelementowym wektorem:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1
\end{verbatim}

Proste ciągi o różnicy równej 1 można generować wykorzystując dwukropek:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}

lub

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{5}\SpecialCharTok{:{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -5 -4 -3 -2 -1  1  2  3  4  5
\end{verbatim}

Do generowania ciągów liczbowych o różnych różnicach wykorzystuje się funkcję \texttt{seq}, która przyjmuje następujące argumenty. Wartość początkową \texttt{from}, wartość końcową \texttt{to} oraz jeden z następujących: \texttt{by} - krok lub \texttt{length.out} - oczekiwana długość wektora.

To samo co \texttt{1:10}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}

Wartości niecałkowite:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\FloatTok{0.2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.0 1.2 1.4 1.6 1.8 2.0
\end{verbatim}

Wektor wartości malejących:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{, }\AttributeTok{by=}\DecValTok{1}\NormalTok{) }\CommentTok{\# błędny zapis}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Error in seq.default(10, 1, by = 1): wrong sign in 'by' argument
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{, }\AttributeTok{by=}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{) }\CommentTok{\# poprawny zapis}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 10  9  8  7  6  5  4  3  2  1
\end{verbatim}

Tworzenie wektora w oparciu o argument \texttt{length.out} - funkcja sama dobiera krok:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{7}\NormalTok{, }\AttributeTok{length.out =} \DecValTok{13}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5 7.0
\end{verbatim}

Do generowania liczb pseudolosowych służy funkcja \texttt{runif(n)}, która do poprawnego wywołania wymaga tylko jednego argumentu - długości wektora wynikowego. Domyślnie losowane są liczby z przedziału \([0;1]\) (tak jak w funkcji \texttt{los()} w Excelu), można to jednak zmienić podając odpowiednie wartości argumentów \texttt{min} i \texttt{max}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{runif}\NormalTok{(}\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.645086575 0.390191614 0.631319303 0.064505834 0.234808099 0.002340352
\end{verbatim}

Obserwacje można także generować z innych rozkładów:

\begin{itemize}
\tightlist
\item
  \texttt{rnorm} - rozkład normalny,
\item
  \texttt{rchisq} - rozkład \(\chi^2\),
\item
  \texttt{rt} - rozkład t-studenta,
\item
  itp.
\end{itemize}

Wykaz wszystkich dostępnych w R rozkładów uzyskamy wywołując polecenie \texttt{help("Distributions")}.

Za każdym uruchomieniem jednej z wymienionych wyżej funkcji losujących wartości z danego rozkładu otrzymamy inne wartości:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{runif}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.3709323 0.6485009 0.6707011 0.8488970 0.1535202
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{runif}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.3556888 0.7778026 0.8799568 0.5817308 0.8520157
\end{verbatim}

Powtarzalność wyników możemy uzyskać ustalając ziarno generatora:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\FunctionTok{runif}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2875775 0.7883051 0.4089769 0.8830174 0.9404673
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\FunctionTok{runif}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2875775 0.7883051 0.4089769 0.8830174 0.9404673
\end{verbatim}

\hypertarget{wektor-wartoux15bci-tekstowych}{%
\subsection{Wektor wartości tekstowych}\label{wektor-wartoux15bci-tekstowych}}

W wektorze może być przechowywany tekst - wówczas poszczególne elementy zapisujemy w cudzysłowie lub apostrofach:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\StringTok{"ala"}\NormalTok{, }\StringTok{"ma"}\NormalTok{, }\StringTok{"kota"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "ala"  "ma"   "kota"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}ala\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ma\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}kota\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "ala"  "ma"   "kota"
\end{verbatim}

W RStudio wygodniej używać cudzysłowu, ponieważ program automatycznie go zamyka.

Istnieje także stała zawierająca litery alfabetu:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{letters}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"
## [20] "t" "u" "v" "w" "x" "y" "z"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{LETTERS}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q" "R" "S"
## [20] "T" "U" "V" "W" "X" "Y" "Z"
\end{verbatim}

\hypertarget{przeciux105ux17canie-wektora}{%
\subsection{Przeciążanie wektora}\label{przeciux105ux17canie-wektora}}

Jeśli w wektorze pomieszamy kilka typów zmiennych to R przekształci poszczególne wartości, tak aby stracić jak najmniej informacji:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\StringTok{"cztery"}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "3"      "cztery" "5"
\end{verbatim}

W pierwszym przypadku wartość \texttt{TRUE} została przekształcona na odpowiednik liczbowy - 1. Z kolei w drugim przykładzie podane liczby zostały przekonwertowane na tekst.

\hypertarget{operacje-na-wektorach}{%
\subsection{Operacje na wektorach}\label{operacje-na-wektorach}}

Na wektorach logicznych i liczbowych można wykonywać operacje arytmetyczne np. mnożenie:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\SpecialCharTok{*}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  2  4  6  8 10 12 14 16 18 20
\end{verbatim}

Wektor liczbowy plus wektor liczbowy:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10} \SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  2  4  4  6  6  8  8 10 10 12
\end{verbatim}

Wektor liczbowy razy wektor liczbowy:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10} \SpecialCharTok{*} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  1  4  3  8  5 12  7 16  9 20
\end{verbatim}

Wektor liczbowy razy wektor logiczny:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10} \SpecialCharTok{*} \FunctionTok{c}\NormalTok{(T, F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1 0 3 0 5 0 7 0 9 0
\end{verbatim}

Długości obu wektorów muszą być odpowiednie:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10} \SpecialCharTok{*} \FunctionTok{c}\NormalTok{(T,F,T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in 1:10 * c(T, F, T): longer object length is not a multiple of shorter
## object length
\end{verbatim}

\begin{verbatim}
##  [1]  1  0  3  4  0  6  7  0  9 10
\end{verbatim}

Dłuższy z wektorów musi być wielokrotnością krótszego.

Siłą rzeczy działania arytmetyczne na wektorach tekstowych nie są możliwe:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\StringTok{"jeden"}\NormalTok{, }\StringTok{"dwa"}\NormalTok{, }\StringTok{"trzy"}\NormalTok{, }\StringTok{"cztery"}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(T,F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Error in c("jeden", "dwa", "trzy", "cztery") * c(T, F): non-numeric argument to binary operator
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\StringTok{"jeden"}\NormalTok{, }\StringTok{"dwa"}\NormalTok{, }\StringTok{"trzy"}\NormalTok{, }\StringTok{"cztery"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Error in c("jeden", "dwa", "trzy", "cztery") + c(1, 2): non-numeric argument to binary operator
\end{verbatim}

\hypertarget{operacje-agregujux105ce}{%
\subsection{Operacje agregujące}\label{operacje-agregujux105ce}}

Na wektorach można także wykonywać operacje agregujące:

\begin{longtable}[]{@{}cl@{}}
\toprule
Funkcja & Działanie \\
\midrule
\endhead
mean() & średnia elementów \\
sum() & suma elementów \\
prod() & iloczyn elementów \\
var() & wariancja elementów \\
sd() & odchylenie standardowe elementów \\
median() & mediana elementów \\
quantile() & kwantyl danego rzędu \\
min() & minimum \\
max() & maksimum \\
\bottomrule
\end{longtable}

Obliczenie skośności i kurtozy jest możliwe po zainstalowaniu pakietu \texttt{e1071}. Wówczas mamy dostęp do funkcji:

\begin{longtable}[]{@{}cl@{}}
\toprule
Funkcja & Działanie \\
\midrule
\endhead
skewness() & skośność elementów \\
kurtosis() & kurtoza elementów \\
\bottomrule
\end{longtable}

Suma wektora numerycznego:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 55
\end{verbatim}

Suma i średnia wektora logicznego:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(}\FunctionTok{c}\NormalTok{(T, F, F, T))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(T, F, F, T))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.5
\end{verbatim}

Korzystanie z funkcji pochodzących z pakietów zewnętrznych wymaga wskazania skąd pochodzi dana funkcja. Można to zrobić na dwa sposoby: funkcją \texttt{library(pakiet)} - wówczas wszystkie funkcje z tego pakietu są wczytywane do pamięci i można do nich sięgać bezpośrednio lub wskazując przed nazwą funkcji z jakiego pakietu pochodzi.

Wczytanie pakietu:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(e1071)}
\FunctionTok{skewness}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{13}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.3451259
\end{verbatim}

lub równoważnie:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{e1071}\SpecialCharTok{::}\FunctionTok{skewness}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{13}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.3451259
\end{verbatim}

Podsumowanie rozkładu wektora można także uzyskać z wykorzystaniem funkcji \texttt{summary(x)}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00    3.25    5.50    5.50    7.75   10.00
\end{verbatim}

Działa także na wektorach tekstowych:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"jeden"}\NormalTok{, }\StringTok{"dwa"}\NormalTok{, }\StringTok{"trzy"}\NormalTok{, }\StringTok{"cztery"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Length     Class      Mode 
##         4 character character
\end{verbatim}

\hypertarget{sprawdzanie-typu-wektora}{%
\subsection{Sprawdzanie typu wektora}\label{sprawdzanie-typu-wektora}}

Do określenia typu wektora służy funkcja \texttt{typeof}, \texttt{class} lub \texttt{mode}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{typeof}\NormalTok{(wart\_log)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "logical"
\end{verbatim}

Sprawdzenie czy obiekt jest danego typu odbywa się z wykorzystaniem dedykowanych funkcji z przyrostkiem \texttt{is.}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.logical}\NormalTok{(wart\_log)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.character}\NormalTok{(wart\_log)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE
\end{verbatim}

\hypertarget{rzutowanie-wektoruxf3w}{%
\subsection{Rzutowanie wektorów}\label{rzutowanie-wektoruxf3w}}

Czasami jako np. argument funkcji będzie wymagany inny typ wektora aniżeli aktualnie posiadany w pamięci. Można wówczas spróbować przekształcić taki wektor z wykorzystaniem funkcji rozpoczynającej się od \texttt{as.}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{typeof}\NormalTok{(wart\_log)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "logical"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as.numeric}\NormalTok{(wart\_log)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 0 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{typeof}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(wart\_log))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "double"
\end{verbatim}

\hypertarget{indeksowanie-wektoruxf3w}{%
\subsection{Indeksowanie wektorów}\label{indeksowanie-wektoruxf3w}}

Aby uzyskać dostęp do części wektora korzysta się z indeksatora w postaci nawiasów kwadratowych. Utworzymy nowy wektor zawierający liczby całkowite od 10 do 20:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wart\_10\_20 }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{10}\NormalTok{,}\DecValTok{20}\NormalTok{)}
\NormalTok{wart\_10\_20}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 10 11 12 13 14 15 16 17 18 19 20
\end{verbatim}

a następnie wybieramy trzecią obserwację:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wart\_10\_20[}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 12
\end{verbatim}

Możemy także odwołać się do większego zakresu:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wart\_10\_20[}\DecValTok{3}\SpecialCharTok{:}\DecValTok{5}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 12 13 14
\end{verbatim}

I wybranych elementów:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wart\_10\_20[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10 12 14
\end{verbatim}

W ten sposób można także modyfikować odpowiednie elementy wektora:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wart\_10\_20[}\DecValTok{7}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{90}
\end{Highlighting}
\end{Shaded}

Wybór obserwacji większych od 15:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wart\_10\_20[wart\_10\_20}\SpecialCharTok{\textgreater{}}\DecValTok{15}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 90 17 18 19 20
\end{verbatim}

Z kolei następujący zapis zwróci nam wektor wartości logicznych:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wart\_10\_20 }\SpecialCharTok{\textgreater{}} \DecValTok{15}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
\end{verbatim}

\hypertarget{wartoux15bci-nieliczbowe}{%
\subsection{Wartości nieliczbowe}\label{wartoux15bci-nieliczbowe}}

Brak danych w R jest przedstawiany jako wartość \texttt{NA} (ang. \emph{not available}) i może powodować trudności z wywoływaniem niektórych funkcji:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v\_na }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\ConstantTok{NA}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{v\_na}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  1  2  1 NA  1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(v\_na)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] NA
\end{verbatim}

W związku z tym większość funkcji ma zaimplementowany dodatkowy argument służący do obsługi tego typu wartości, który najczęściej nie uwzględnia tych wartości w obliczeniach:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(v\_na, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5
\end{verbatim}

Oprócz braku danych podczas obliczeń możemy natrafić na wartości nieokreślone \texttt{NaN} (ang. \emph{not a number}) oraz nieskończone \texttt{Inf} (ang. \emph{infinity}).

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{0}\SpecialCharTok{/}\DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] NaN
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{/}\DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] Inf
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sqrt}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in sqrt(-10): NaNs produced
\end{verbatim}

\begin{verbatim}
## [1] NaN
\end{verbatim}

W R istnieje także wartość \texttt{NULL}, która jest podstawowym typem danych a nie wartością. \texttt{NULL} można traktować jako odpowiednik zbioru pustego. Jest stosowany np. w funkcjach, które niczego nie zwracają.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v\_null }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\ConstantTok{NULL}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{v\_null}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 1 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(v\_null)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5
\end{verbatim}

\hypertarget{zadania}{%
\subsection{Zadania}\label{zadania}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Ile wynosi suma elementów większych od 10 dla następujących liczb: \texttt{12,\ 5,\ 20,\ 18,\ 8.5,\ 10,\ 4,\ 101,\ -2}?
\item
  Z wykorzystaniem funkcji \texttt{seq} i na podstawie wektora \ldots{} dokonaj przekształcenia tworząc następujący wektor: \texttt{2\ 0\ 0\ 4\ 0\ 0\ 6\ 0\ 0\ 8\ 0\ 0}.
\item
  Dane są dwa wektory - a: \texttt{2,\ 3,\ 7,\ 8,\ 2}, b: \texttt{9,\ 1,\ 2,\ 0,\ 2}. Jakiego typu będzie wektor będący wynikiem działania \texttt{a\textless{}=b}?
\item
  Uzupełnij wektor \texttt{letters} o polskie litery diakrytyzowane. Jaką długość ma nowo utworzony wektor?
\item
  Wylosuj z rozkładu normalnego 1000 obserwacji z ziarnem równym 76. Ile wynosi kurtoza tych wartości?
\end{enumerate}

\hypertarget{macierz}{%
\section{Macierz}\label{macierz}}

Macierze są wykorzystywane w R do przechowywania np. odległości pomiędzy punktami czy wskazywania sąsiedztwa obszarów geograficznych.

Do tworzenia macierzy służy funkcja \texttt{matrix}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{ncol=}\DecValTok{3}\NormalTok{)}
\NormalTok{m}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
\end{verbatim}

Z wykorzystaniem wybranych funkcji można sprawdzić wymiary macierzy, liczbę wierszy oraz kolumn:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ncol}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{nrow}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2
\end{verbatim}

Macierz może także zawierać tekst:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{matrix}\NormalTok{(letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{], }\AttributeTok{nrow=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,] "a"  "d"  "g" 
## [2,] "b"  "e"  "h" 
## [3,] "c"  "f"  "i"
\end{verbatim}

Domyślnie macierz układana jest kolumnami. Aby to zmienić należy dodać argument \texttt{byrow=TRUE}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{matrix}\NormalTok{(letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{], }\AttributeTok{nrow=}\DecValTok{3}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,] "a"  "b"  "c" 
## [2,] "d"  "e"  "f" 
## [3,] "g"  "h"  "i"
\end{verbatim}

Jeśli liczba elementów wejściowych jest mniejsza iloczyn podanej liczby kolumn i wierszy to w brakujące miejsce wstawiane są elementy z początku wektora wejściowego:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{matrix}\NormalTok{(letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{7}\NormalTok{], }\AttributeTok{nrow=}\DecValTok{3}\NormalTok{, }\AttributeTok{byrow=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in matrix(letters[1:7], nrow = 3, byrow = TRUE): data length [7] is not
## a sub-multiple or multiple of the number of rows [3]
\end{verbatim}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,] "a"  "b"  "c" 
## [2,] "d"  "e"  "f" 
## [3,] "g"  "a"  "b"
\end{verbatim}

Z kolei macierz diagnonalną posiadającą elementy niezerowe wyłącznie na przekątnej tworzy się z wykorzystaniem funkcji \texttt{diag}. Macierz jednostkowa o wymiarach \(4 \times 4\):

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{diag}\NormalTok{(}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3] [,4]
## [1,]    1    0    0    0
## [2,]    0    1    0    0
## [3,]    0    0    1    0
## [4,]    0    0    0    1
\end{verbatim}

Macierz diagonalna o wartościach 5 na przekątnej i wymiarach \(3 \times 3\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{diag}\NormalTok{(}\DecValTok{5}\NormalTok{, }\AttributeTok{nrow=}\DecValTok{3}\NormalTok{, }\AttributeTok{ncol=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    5    0    0
## [2,]    0    5    0
## [3,]    0    0    5
\end{verbatim}

Funkcja \texttt{diag} umożliwia także ekstrakcję przekątnej z istniejącej już macierzy:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{diag}\NormalTok{(}\FunctionTok{matrix}\NormalTok{(letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{], }\AttributeTok{nrow=}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "a" "e" "i"
\end{verbatim}

\hypertarget{ux142ux105czenie-macierzy}{%
\subsection{Łączenie macierzy}\label{ux142ux105czenie-macierzy}}

Z wykorzystaniem funkcji \texttt{rbind} i \texttt{cbind} można odpowiednio łączyć obiekty wierszami (ang. \emph{row bind}) lub kolumnami (ang. \emph{col bind}):

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rbind}\NormalTok{(m, }\FunctionTok{c}\NormalTok{(}\DecValTok{99}\NormalTok{, }\DecValTok{88}\NormalTok{, }\DecValTok{77}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
## [3,]   99   88   77
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cbind}\NormalTok{(m, }\FunctionTok{matrix}\NormalTok{(}\DecValTok{101}\SpecialCharTok{:}\DecValTok{104}\NormalTok{, }\AttributeTok{nrow=}\DecValTok{2}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    3    5  101  103
## [2,]    2    4    6  102  104
\end{verbatim}

\hypertarget{indeksowanie-macierzy}{%
\subsection{Indeksowanie macierzy}\label{indeksowanie-macierzy}}

Dostęp do poszczególnych elementów macierzy odbywa się z wykorzystaniem nawiasów kwadratowych, ale można podać dwie wartość - \texttt{obiekt{[}wiersz,kolumna{]}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{] }\CommentTok{\# drugi wiersz, pierwsza kolumna}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m[}\DecValTok{2}\NormalTok{,]  }\CommentTok{\# tylko drugi wiersz}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2 4 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m[,}\DecValTok{1}\NormalTok{]  }\CommentTok{\# tylko pierwsza kolumna}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m[,]   }\CommentTok{\# wszystkie obserwacje}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m[]    }\CommentTok{\# wszystkie obserwacje}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
\end{verbatim}

W ten sposób można dokonać modyfikacji konkretnych elementów macierzy:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{77}
\NormalTok{m}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]   77    4    6
\end{verbatim}

\hypertarget{operacje-na-macierzach}{%
\subsection{Operacje na macierzach}\label{operacje-na-macierzach}}

Na macierzach można wywołać szereg operacji:

\begin{longtable}[]{@{}cl@{}}
\toprule
Operator/funkcja & Działanie \\
\midrule
\endhead
a \%*\% b & mnożenie macierzy a i b \\
t(a) & transpozycja macierzy a \\
det(a) & wyznacznik macierzy a \\
solve(a) & macierz odwrotna z a \\
solve(a, b) & rozwiązanie układu a*x=b \\
\bottomrule
\end{longtable}

Rozważmy dwie macierze:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{)}
\NormalTok{b }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{6}\SpecialCharTok{:}\DecValTok{1}\NormalTok{, }\AttributeTok{ncol=}\DecValTok{2}\NormalTok{)}
\NormalTok{a;b}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    2    2    1
## [2,]    3    1    3
## [3,]    4    2    2
\end{verbatim}

\begin{verbatim}
##      [,1] [,2]
## [1,]    6    3
## [2,]    5    2
## [3,]    4    1
\end{verbatim}

Aby przeprowadzić mnożenie macierzy \texttt{a} i \texttt{b}, liczba kolumn macierzy \texttt{a} musi być równa liczbie wierszy w macierzy \texttt{b}. Z kolei rozmiar macierzy wyjściowej to liczba wierszy macierzy \texttt{a} i liczba kolumn macierzy \texttt{b}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\SpecialCharTok{\%*\%}\NormalTok{ b}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]   26   11
## [2,]   35   14
## [3,]   42   18
\end{verbatim}

Transpozycja macierzy \texttt{b}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t}\NormalTok{(b)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    6    5    4
## [2,]    3    2    1
\end{verbatim}

Wyznacznik macierzy \texttt{a}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{det}\NormalTok{(a)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6
\end{verbatim}

Macierz odwrotna do macierzy \texttt{a}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{solve}\NormalTok{(a)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            [,1]       [,2]       [,3]
## [1,] -0.6666667 -0.3333333  0.8333333
## [2,]  1.0000000  0.0000000 -0.5000000
## [3,]  0.3333333  0.6666667 -0.6666667
\end{verbatim}

Wyznaczenie macierzy \texttt{x} w równaniu \texttt{a*x=b}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{solve}\NormalTok{(a,b)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           [,1]      [,2]
## [1,] -2.333333 -1.833333
## [2,]  4.000000  2.500000
## [3,]  2.666667  1.666667
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\SpecialCharTok{\%*\%} \FunctionTok{solve}\NormalTok{(a,b)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    6    3
## [2,]    5    2
## [3,]    4    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{b}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    6    3
## [2,]    5    2
## [3,]    4    1
\end{verbatim}

\hypertarget{zadanie}{%
\subsection{Zadanie}\label{zadanie}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Co powstanie po przemnożeniu macierzy przez jej macierz odwrotną?
\item
  Estymator parametrów beta w metodzie najmniejszych kwadratów jest dany wzorem:
\end{enumerate}

\[b=(X'X)^{-1}X'y\]

Zmienna \(x_1\) przyjmuje wartości \texttt{2,4,1,6,9,3,2,9,10,7}, zmienna \(x_2\) \texttt{1.5,0.2,0.1,2,3.1,1.2,0.4,2.9,2.5,1.9}, a zmienna \(x_0\) to wektor jedynek. Te trzy zmienne tworzą macierz \(X\). Z kolei wartości zmiennej \(y\) są następujące \texttt{12,15,10,19,26,13,13,21,29,18}. Wyznacz wartość \(b\).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zad1 }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{nrow=}\DecValTok{2}\NormalTok{)}
\FunctionTok{solve}\NormalTok{(zad1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]   -2  1.5
## [2,]    1 -0.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zad1 }\SpecialCharTok{\%*\%} \FunctionTok{solve}\NormalTok{(zad1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    1    0
## [2,]    0    1
\end{verbatim}

\hypertarget{czynnik}{%
\section{Czynnik}\label{czynnik}}

Czynnik (ang. \emph{factor}) służy do przechowywania danych jakościowych o mało licznej liczbie kategorii, mierzonych na skali nominalnej i porządkowej.

Rozważmy informacje o wykształceniu:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wyk }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"podstawowe"}\NormalTok{, }\StringTok{"średnie"}\NormalTok{, }\StringTok{"wyższe"}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\NormalTok{wyk}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "podstawowe" "podstawowe" "podstawowe" "podstawowe" "podstawowe"
##  [6] "średnie"    "średnie"    "średnie"    "wyższe"     "wyższe"
\end{verbatim}

i dokonajmy transformacji na czynnik:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wyk\_f }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(wyk)}
\NormalTok{wyk\_f}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] podstawowe podstawowe podstawowe podstawowe podstawowe średnie   
##  [7] średnie    średnie    wyższe     wyższe    
## Levels: podstawowe średnie wyższe
\end{verbatim}

Funkcja \texttt{summary()} wywołana na czynniku zwraca wynik innego typu aniżeli na wektorze tekstowym:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(wyk)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Length     Class      Mode 
##        10 character character
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(wyk\_f)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## podstawowe    średnie     wyższe 
##          5          3          2
\end{verbatim}

Jeśli chcemy zaakcentować fakt, że zmienne są mierzone na skali porządkowej dodajemy argument \texttt{ordered=TRUE}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wyk\_of }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(wyk, }\AttributeTok{ordered =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{wyk\_of}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] podstawowe podstawowe podstawowe podstawowe podstawowe średnie   
##  [7] średnie    średnie    wyższe     wyższe    
## Levels: podstawowe < średnie < wyższe
\end{verbatim}

W łatwy sposób możemy edytować etykiety:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{levels}\NormalTok{(wyk\_of) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"pod."}\NormalTok{, }\StringTok{"śr."}\NormalTok{, }\StringTok{"wyż."}\NormalTok{)}
\NormalTok{wyk\_of}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] pod. pod. pod. pod. pod. śr.  śr.  śr.  wyż. wyż.
## Levels: pod. < śr. < wyż.
\end{verbatim}

Czynniki mają szczególne znaczenie w przypadku tworzenia wykresów, gdy chcemy określić porządek wyświetlania.

\hypertarget{lista}{%
\section{Lista}\label{lista}}

Listy to ciągi złożone z elementów o dowolnych typach. Mogą przydać się w szczególności przy budowaniu funkcji, które zwracają tylko jedną wartość. Wówczas dane różnego typu mogą być zawarte w takiej liście.

Tworzenie prostej listy:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{l }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{), }\StringTok{"element tekstowy"}\NormalTok{)}
\NormalTok{l}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [[1]]
## [1] TRUE
## 
## [[2]]
## [1] 1 2 3 4
## 
## [[3]]
## [1] "element tekstowy"
\end{verbatim}

Już na pierwszy rzut oka widać bardziej złożoną strukturę listy. W związku z tym odwoływanie do poszczególnych elementów będzie trochę się różnić od wektorów czy macierzy.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{l[}\DecValTok{2}\NormalTok{] }\CommentTok{\# druga lista}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [[1]]
## [1] 1 2 3 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{l[[}\DecValTok{2}\NormalTok{]] }\CommentTok{\# zawartość listy}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 3 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{l[[}\DecValTok{2}\NormalTok{]][}\DecValTok{3}\NormalTok{] }\CommentTok{\# trzeci element wektora drugiej listy}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3
\end{verbatim}

Listę można także rozwinąć do wektora z wykorzystaniem funkcji \texttt{unlist}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unlist}\NormalTok{(l)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "TRUE"             "1"                "2"                "3"               
## [5] "4"                "element tekstowy"
\end{verbatim}

Poszczególne elementy listy można nazwać:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ln }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{log=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{num=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{), }\AttributeTok{tekst=}\StringTok{"element tekstowy"}\NormalTok{)}
\NormalTok{ln}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $log
## [1] TRUE
## 
## $num
## [1] 1 2 3 4
## 
## $tekst
## [1] "element tekstowy"
\end{verbatim}

Wówczas można uzyskać do nich dostęp poprzez symbol \texttt{\$} i podaną nazwę:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ln}\SpecialCharTok{$}\NormalTok{num}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 3 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ln[[}\DecValTok{2}\NormalTok{]] }\CommentTok{\# normalne indeksowanie nadal działa}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 3 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ln}\SpecialCharTok{$}\NormalTok{num[}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2
\end{verbatim}

\hypertarget{ramka-danych}{%
\section{Ramka danych}\label{ramka-danych}}

Ramka danych to tabela, która przypomina tą z Excela zawierająca dane o różnych typach. Tworzona za pomocą funkcji \texttt{data.frame}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{plec=}\FunctionTok{c}\NormalTok{(}\StringTok{"m"}\NormalTok{, }\StringTok{"k"}\NormalTok{, }\StringTok{"k"}\NormalTok{, }\StringTok{"m"}\NormalTok{, }\StringTok{"k"}\NormalTok{, }\StringTok{"m"}\NormalTok{, }\StringTok{"m"}\NormalTok{, }\StringTok{"m"}\NormalTok{),}
                 \AttributeTok{wzrost=}\FunctionTok{c}\NormalTok{(}\DecValTok{173}\NormalTok{, }\DecValTok{170}\NormalTok{, }\DecValTok{163}\NormalTok{, }\DecValTok{178}\NormalTok{, }\DecValTok{169}\NormalTok{, }\DecValTok{180}\NormalTok{, }\DecValTok{175}\NormalTok{, }\ConstantTok{NA}\NormalTok{),}
                 \AttributeTok{pali=}\FunctionTok{c}\NormalTok{(T, F, F, F, T, F, }\ConstantTok{NA}\NormalTok{, T))}
\end{Highlighting}
\end{Shaded}

W RStudio po wybraniu tego obiektu w zakładce \texttt{Environment} pojawia się przyjazne okno do przeglądania oraz poglądowego filtrowania i sortowania danych ze zbioru.

Możemy zobaczyć podsumowanie całego zbioru wywołując na nim funkcję \texttt{summary()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      plec               wzrost         pali        
##  Length:8           Min.   :163.0   Mode :logical  
##  Class :character   1st Qu.:169.5   FALSE:4        
##  Mode  :character   Median :173.0   TRUE :3        
##                     Mean   :172.6   NA's :1        
##                     3rd Qu.:176.5                  
##                     Max.   :180.0                  
##                     NA's   :1
\end{verbatim}

Ramki danych można indeksować w taki sam sposób jak macierze lub z wykorzystaniem operatora \texttt{\$}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[,}\DecValTok{2}\NormalTok{] }\CommentTok{\# druga kolumna}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 173 170 163 178 169 180 175  NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{wzrost }\CommentTok{\# kolumna wzrost}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 173 170 163 178 169 180 175  NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[,}\FunctionTok{c}\NormalTok{(}\StringTok{"plec"}\NormalTok{, }\StringTok{"pali"}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   plec  pali
## 1    m  TRUE
## 2    k FALSE
## 3    k FALSE
## 4    m FALSE
## 5    k  TRUE
## 6    m FALSE
## 7    m    NA
## 8    m  TRUE
\end{verbatim}

Z kolei do wyboru obserwacji można wykorzystać warunek:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[df}\SpecialCharTok{$}\NormalTok{plec}\SpecialCharTok{==}\StringTok{"m"}\NormalTok{,]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   plec wzrost  pali
## 1    m    173  TRUE
## 4    m    178 FALSE
## 6    m    180 FALSE
## 7    m    175    NA
## 8    m     NA  TRUE
\end{verbatim}

Wyodrębnienie informacji o wzroście tylko dla kobiet i wyznaczenie średniej:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wzrost\_k }\OtherTok{\textless{}{-}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{wzrost[df}\SpecialCharTok{$}\NormalTok{plec }\SpecialCharTok{==} \StringTok{"k"}\NormalTok{]}
\NormalTok{wzrost\_k}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 170 163 169
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(wzrost\_k)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 167.3333
\end{verbatim}

Widzimy, że dla mężczyzn nie udało się ustalić wszystkich informacji i jeden z nich nie ma podanego wzrostu, a dla drugiego brakuje informacji o paleniu papierosów. Możemy usunąć braki danych w kolumnach korzystając z funkcji \texttt{complete.cases()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[}\FunctionTok{complete.cases}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{wzrost),] }\CommentTok{\# tylko zmienna wzrost}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   plec wzrost  pali
## 1    m    173  TRUE
## 2    k    170 FALSE
## 3    k    163 FALSE
## 4    m    178 FALSE
## 5    k    169  TRUE
## 6    m    180 FALSE
## 7    m    175    NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[}\FunctionTok{complete.cases}\NormalTok{(df),] }\CommentTok{\# wszystkie zmienne}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   plec wzrost  pali
## 1    m    173  TRUE
## 2    k    170 FALSE
## 3    k    163 FALSE
## 4    m    178 FALSE
## 5    k    169  TRUE
## 6    m    180 FALSE
\end{verbatim}

Zbiory danych przechowywane są także w R i pochodzą z różnych pakietów. Wywołując funkcję \texttt{data("zbior")} ładujemy dany zbiór do pamięci. Do szybkiego podglądu zebranych danych służy funkcja \texttt{head()}, która domyślnie wyświetla 6 pierwszych obserwacji ze zbioru:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"iris"}\NormalTok{)}
\FunctionTok{head}\NormalTok{(iris)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa
\end{verbatim}

\hypertarget{zadania-1}{%
\subsection{Zadania}\label{zadania-1}}

Załaduj do pamięci zbiór o nazwie ChickWeight.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Ile razy jedzenie otrzymał kurczak o numerze 15?
\item
  Ile wynosi mediana wagi kurczaka o numerze 35?
\item
  Ile średnio ważyły kurczaki na diecie nr 1, a ile na diecie nr 2?
\end{enumerate}

\hypertarget{przetwarzanie-danych}{%
\chapter{Przetwarzanie danych}\label{przetwarzanie-danych}}

\href{presentations/02_wczytywanie.html}{Prezentacja - wczytywanie danych}

\href{presentations/03_przetwarzanie.html}{Prezentacja - przetwarzanie}

\hypertarget{wprowadzenie---pakiet-tidyverse}{%
\section{Wprowadzenie - pakiet tidyverse}\label{wprowadzenie---pakiet-tidyverse}}

Pakiet \texttt{tidyverse} to zestaw pakietów do kompleksowego przetwarzania i wizualizacji danych. Ładuje następujące pakiety:

\begin{itemize}
\tightlist
\item
  ggplot2 - tworzenie wykresów,
\item
  dplyr - przetwarzanie danych,
\item
  tidyr - zmiana reprezentacji danych,
\item
  readr - wczytywanie danych tekstowych,
\item
  purrr - programowanie funkcyjne
\item
  tibble - sposób przechowywania danych,
\item
  stringr - przetwarzanie tekstów,
\item
  forcats - przetwarzanie faktorów
\end{itemize}

Manifest tidyverse ustala następujące zasady:

\begin{itemize}
\tightlist
\item
  powtórne użycie istniejących struktur danych,
\item
  tworzenie czytelnych kodów z operatorem pipe \texttt{\%\textgreater{}\%} (ang. rura, przewód, łącznik).
\end{itemize}

Wobec tego załadujmy pakiet \texttt{tidyverse}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.6     v dplyr   1.0.7
## v tidyr   1.1.4     v stringr 1.4.0
## v readr   2.1.1     v forcats 0.5.1
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

W konsoli pojawi się informacja o wersji załadowanych pakietów oraz o konfliktach występujących pomiędzy pakietami. Konflikty te wynikają z takich samych nazw funkcji w różnych pakietach. Kolejność wczytywania pakietów ma znaczenie - kolejny pakiet przykryje funkcje z wcześniej wczytanego. Wywołanie przykrytej funkcji jest możliwe poprzez zapis \texttt{nazwa\_pakietu::nazwa\_funkcji}.

Korzystanie z pakietu i zasad \texttt{tidyverse} to dużo bardziej czytelny kod w porównaniu do wbudowanych funkcji. Poniżej przedstawiony jest przykład przetwarzania danych polegający na filtrowaniu, wyborze kolumn oraz utworzeniu nowej zmiennej.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"ChickWeight"}\NormalTok{)}

\CommentTok{\# bez pakietu tidyverse}

\NormalTok{chick\_15 }\OtherTok{\textless{}{-}}\NormalTok{ ChickWeight[ChickWeight}\SpecialCharTok{$}\NormalTok{Chick}\SpecialCharTok{==}\StringTok{"15"}\NormalTok{,]}
\NormalTok{chick\_15 }\OtherTok{\textless{}{-}}\NormalTok{ chick\_15[}\FunctionTok{c}\NormalTok{(}\StringTok{"weight"}\NormalTok{, }\StringTok{"Time"}\NormalTok{, }\StringTok{"Diet"}\NormalTok{),]}
\NormalTok{chick\_15}\SpecialCharTok{$}\NormalTok{weight\_kg }\OtherTok{\textless{}{-}}\NormalTok{ chick\_15}\SpecialCharTok{$}\NormalTok{weight}\SpecialCharTok{/}\DecValTok{1000}

\CommentTok{\# z pakietem tidyverse}

\NormalTok{chick\_15 }\OtherTok{\textless{}{-}}\NormalTok{ ChickWeight }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(Chick}\SpecialCharTok{==}\StringTok{"15"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Chick) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{weight\_kg=}\NormalTok{weight}\SpecialCharTok{/}\DecValTok{1000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Rozwiązanie z wykorzystaniem wbudowanych funkcji to 133 znaki, natomiast wykorzystanie \texttt{tidyverse} to 30\% oszczędność miejsca i tylko 92 znaki.

\hypertarget{import-danych}{%
\section{Import danych}\label{import-danych}}

Wczytywanie danych do R jest możliwe z wielu różnych źródeł. Funkcje, które to umożliwiają zwykle mają nazwę rozpoczynającą się od \texttt{read}.

Będziemy korzystać z następujących zbiorów danych:

\begin{itemize}
\tightlist
\item
  \href{data/movies.csv}{movies} - plik tekstowy zawierający informacje o filmach,
\item
  \href{data/bank.xlsx}{bank} - plik excel zawierający dane dot. kampanii marketingowej banku, \href{data/bank_opis.pdf}{opis zmiennych},
\item
  \href{data/rossmann.xlsx}{rossmann} - plik excel zawierający dane ze sklepów Rossmann,
\item
  \href{http://www.mbnet.com.pl/dl.txt}{lotto} - plik tekstowy zawierający dane z losowań Lotto.
\end{itemize}

\hypertarget{pliki-csv}{%
\subsection{Pliki CSV}\label{pliki-csv}}

Do wczytywania plików csv można wykorzystać wbudowaną funkcję \texttt{read.csv()} lub tą pochodzącą z pakietu \texttt{readr} - \texttt{read\_csv()}. W obu przypadkach wynik wczytania będzie podobny.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{movies }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"data/movies.csv"}\NormalTok{)}

\NormalTok{movies2 }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data/movies.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 2961 Columns: 11
\end{verbatim}

\begin{verbatim}
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr (3): title, genre, director
## dbl (8): year, duration, gross, budget, cast_facebook_likes, votes, reviews,...
\end{verbatim}

\begin{verbatim}
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

Jeśli nas plik ma nietypową strukturę to w funkcji \texttt{read.csv()} możemy określić dodatkowe argumenty informując o nazwach kolumn obecnych w pliku (\texttt{header\ =}), separatorze kolumn (\texttt{sep\ =}) lub separatorze miejsc dziesiętnych (\texttt{dec\ =})

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{movies }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\AttributeTok{file =} \StringTok{"data/movies.csv"}\NormalTok{, }\AttributeTok{header =}\NormalTok{ T, }\AttributeTok{sep=}\StringTok{","}\NormalTok{, }\AttributeTok{dec=}\StringTok{"."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{pliki-excel}{%
\subsection{Pliki excel}\label{pliki-excel}}

Do wczytywania plików z Excela niezbędny jest dodatkowy pakiet \texttt{readxl}. W funkcji \texttt{read\_xlsx()} podajemy jako argument nazwę pliku. Możemy także dodać nazwę lub numer arkusza w argumencie (\texttt{sheet\ =}) oraz zakres komórek jako wartość argumentu \texttt{range\ =}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readxl)}

\NormalTok{bank }\OtherTok{\textless{}{-}} \FunctionTok{read\_xlsx}\NormalTok{(}\StringTok{"data/bank.xlsx"}\NormalTok{)}

\CommentTok{\# bank \textless{}{-} read\_xlsx("data/bank.xlsx", sheet = "dane")}
\CommentTok{\# bank \textless{}{-} read\_xlsx("data/bank.xlsx", sheet = 1)}

\NormalTok{bank\_a1i30 }\OtherTok{\textless{}{-}} \FunctionTok{read\_xlsx}\NormalTok{(}\StringTok{"data/bank.xlsx"}\NormalTok{, }\AttributeTok{range =} \StringTok{"A1:I30"}\NormalTok{)}

\NormalTok{rossmann }\OtherTok{\textless{}{-}} \FunctionTok{read\_xlsx}\NormalTok{(}\StringTok{"data/rossmann.xlsx"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{pliki-tekstowe}{%
\subsection{Pliki tekstowe}\label{pliki-tekstowe}}

Z kolei do wczytywania plików tekstowych wykorzystuje się funkcję \texttt{read.table()}. Wczytywany plik nie musi być zlokalizowany na dysku twardym - może to być link internetowy.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lotto }\OtherTok{\textless{}{-}} \FunctionTok{read.table}\NormalTok{(}\StringTok{"http://www.mbnet.com.pl/dl.txt"}\NormalTok{)}
\FunctionTok{names}\NormalTok{(lotto) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"lp"}\NormalTok{, }\StringTok{"data"}\NormalTok{, }\StringTok{"numery"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{filtrowanie}{%
\section{Filtrowanie}\label{filtrowanie}}

Do przetwarzania danych służą funkcje z pakietu \texttt{dplyr}. Większość z nich jako pierwszy argument przyjmuje przetwarzany zbiór danych, ale można tego uniknąć wykorzystując symbole \texttt{\%\textgreater{}\%}.

Filtrowanie polega na wybraniu obserwacji, które spełniają określony warunek lub warunki. Ze zbioru \texttt{movies} wybierzmy wszystkie komedie:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(movies, genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

lub alternatywnie:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Po zmiennej, która jest filtrowana musimy podać operator porównania czyli podwójny znak równości \texttt{==}. Jeśli chcemy filtrować po większej liczbie zmiennych to kolejne warunki dodajemy po przecinku:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie\_2012 }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{, year}\SpecialCharTok{==}\DecValTok{2012}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Wówczas oba warunki muszą zostać spełnione czyli pomiędzy nimi zachodzi relacja \texttt{i}. Równoważny zapis jest następujący:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie\_2012 }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"} \SpecialCharTok{\&}\NormalTok{ year}\SpecialCharTok{==}\DecValTok{2012}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Pomiędzy warunkami może także zachodzić relacja \texttt{lub}. Wybieramy filmy, które są komediami \textbf{lub} miały swoją premierę w 2012 roku.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie\_l\_2012 }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"} \SpecialCharTok{|}\NormalTok{ year}\SpecialCharTok{==}\DecValTok{2012}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Możliwy jest także wybór wielu kryteriów filtrowania poprzez operator \texttt{\%in\%}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie\_familijne }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"Comedy"}\NormalTok{, }\StringTok{"Family"}\NormalTok{))}

\NormalTok{movies\_2000\_2010 }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\%in\%} \DecValTok{2000}\SpecialCharTok{:}\DecValTok{2010}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{wybieranie-kolumn}{%
\section{Wybieranie kolumn}\label{wybieranie-kolumn}}

Do wyboru kolumn służy funkcja \texttt{select()}. Zmodyfikujemy wcześniej utworzony zbiór \texttt{komedie}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(title, year, duration, budget, rating)}
\end{Highlighting}
\end{Shaded}

Ten sam kod możemy zapisać zagnieżdżając funkcje, ale traci on w ten sposób na czytelności:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie }\OtherTok{\textless{}{-}} \FunctionTok{select}\NormalTok{(}\FunctionTok{filter}\NormalTok{(movies, genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{), title, year, duration, budget, rating)}
\end{Highlighting}
\end{Shaded}

Możemy także wskazać, które zmienne nie mają znaleźć się w zbiorze wynikowym:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{genre)}
\end{Highlighting}
\end{Shaded}

Natomiast jeśli zmiennych jest więcej to musimy jest umieścić w wektorze, żeby nie pisać przed każdą zmienną znaku minus:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{genre, }\SpecialCharTok{{-}}\NormalTok{director, }\SpecialCharTok{{-}}\NormalTok{gross, }\SpecialCharTok{{-}}\NormalTok{budget)}


\NormalTok{komedie }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(genre, director, gross, budget))}
\end{Highlighting}
\end{Shaded}

Z wykorzystaniem znaku dwukropka możemy także wskazywać zakresy zmiennych:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{genre, }\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(gross}\SpecialCharTok{:}\NormalTok{reviews))}
\end{Highlighting}
\end{Shaded}

\hypertarget{tworzenie-nowych-zmiennych}{%
\section{Tworzenie nowych zmiennych}\label{tworzenie-nowych-zmiennych}}

Do utworzenia nowej zmiennej wykorzystuje się funkcję \texttt{mutate()}. Utwórzmy w naszym zbiorze nową zmienną, która będzie zawierała czas trwania filmu w godzinach:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{genre, }\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(gross}\SpecialCharTok{:}\NormalTok{reviews)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dur\_hour =}\NormalTok{ duration}\SpecialCharTok{/}\DecValTok{60}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Rozsądnie będzie zaokrąglić otrzymaną wartość do jednego miejsca po przecinku - służy do tego funkcja \texttt{round()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{genre, }\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(gross}\SpecialCharTok{:}\NormalTok{reviews)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dur\_hour =} \FunctionTok{round}\NormalTok{(duration}\SpecialCharTok{/}\DecValTok{60}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Z kolei funkcja \texttt{transmute()} tworzy zbiór w którym jest tylko nowo utworzona kolumna:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{komedie\_t }\OtherTok{\textless{}{-}}\NormalTok{ movies }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(genre}\SpecialCharTok{==}\StringTok{"Comedy"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{genre, }\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(gross}\SpecialCharTok{:}\NormalTok{reviews)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{transmute}\NormalTok{(}\AttributeTok{dur\_hour =} \FunctionTok{round}\NormalTok{(duration}\SpecialCharTok{/}\DecValTok{60}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{zmiana-nazwy-zmiennej}{%
\section{Zmiana nazwy zmiennej}\label{zmiana-nazwy-zmiennej}}

Do zmiany nazw zmiennych służy funkcja \texttt{rename()}. Najpierw podajemy nazwę nowej zmiennej, a po znaku równości starą nazwę:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank }\OtherTok{\textless{}{-}}\NormalTok{ bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{karta=}\NormalTok{kredyt)}
\end{Highlighting}
\end{Shaded}

Zmiany nazwy można także dokonać z wykorzystaniem funkcji \texttt{select}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank\_nowy }\OtherTok{\textless{}{-}}\NormalTok{ bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\AttributeTok{lokata=}\NormalTok{wynik)}
\end{Highlighting}
\end{Shaded}

W takim przypadku trzeba jednak pamiętać o wypisaniu wszystkich zmiennych, które mają się znaleźć w zbiorze wynikowym.

\hypertarget{podsumowanie-danych}{%
\section{Podsumowanie danych}\label{podsumowanie-danych}}

Funkcja \texttt{summarise()} służy do podsumowań danych w formie zagregowanej:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{saldo\_srednia=}\FunctionTok{mean}\NormalTok{(saldo),}
            \AttributeTok{saldo\_mediana=}\FunctionTok{median}\NormalTok{(saldo))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 2
##   saldo_srednia saldo_mediana
##           <dbl>         <dbl>
## 1         1362.           448
\end{verbatim}

Podsumowanie danych ma najwięcej sensu w połączniu z funkcją grupującą.

\hypertarget{grupowanie}{%
\section{Grupowanie}\label{grupowanie}}

Do grupowania obserwacji służy funkcja \texttt{group\_by()}. Zobaczmy jak wyglądają statystyki salda w poszczególnych grupach wykształcenia:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(wykszt) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{saldo\_srednia=}\FunctionTok{mean}\NormalTok{(saldo),}
            \AttributeTok{saldo\_mediana=}\FunctionTok{median}\NormalTok{(saldo))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 3
##   wykszt     saldo_srednia saldo_mediana
##   <chr>              <dbl>         <dbl>
## 1 podstawowe         1251.           403
## 2 srednie            1155.           392
## 3 wyzsze             1758.           577
## 4 <NA>               1527.           568
\end{verbatim}

Po przecinku w funkcji \texttt{group\_by()} można wskazać kolejne zmienne grupujące:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(wykszt, hipoteka) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{saldo\_srednia=}\FunctionTok{mean}\NormalTok{(saldo),}
            \AttributeTok{saldo\_mediana=}\FunctionTok{median}\NormalTok{(saldo))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'wykszt'. You can override using the `.groups` argument.
\end{verbatim}

\begin{verbatim}
## # A tibble: 8 x 4
## # Groups:   wykszt [4]
##   wykszt     hipoteka saldo_srednia saldo_mediana
##   <chr>      <chr>            <dbl>         <dbl>
## 1 podstawowe nie              1571.          521 
## 2 podstawowe tak              1008.          344.
## 3 srednie    nie              1340.          416.
## 4 srednie    tak              1034.          380 
## 5 wyzsze     nie              1919.          618 
## 6 wyzsze     tak              1584.          543 
## 7 <NA>       nie              1780.          679 
## 8 <NA>       tak              1207.          442
\end{verbatim}

Przydatna jest także funkcja \texttt{n()}, która nie przyjmuje żadnego argumentu i zwraca liczebność zbioru bądź grupy.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(wykszt) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{liczebnosc=}\FunctionTok{n}\NormalTok{(),}
            \AttributeTok{saldo\_srednia=}\FunctionTok{mean}\NormalTok{(saldo),}
            \AttributeTok{saldo\_mediana=}\FunctionTok{median}\NormalTok{(saldo))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 4
##   wykszt     liczebnosc saldo_srednia saldo_mediana
##   <chr>           <int>         <dbl>         <dbl>
## 1 podstawowe       6851         1251.           403
## 2 srednie         23202         1155.           392
## 3 wyzsze          13301         1758.           577
## 4 <NA>             1857         1527.           568
\end{verbatim}

Jeżeli chcemy tylko wyznaczyć liczebności grup to możemy skorzystać z funkcji \texttt{count()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(wykszt) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
## # Groups:   wykszt [4]
##   wykszt         n
##   <chr>      <int>
## 1 podstawowe  6851
## 2 srednie    23202
## 3 wyzsze     13301
## 4 <NA>        1857
\end{verbatim}

Jedną z kategorii zmiennej wykształcenie jest brak danych (\texttt{NA}). Zamienimy tą wartość na kategorię \emph{nieustalone} z wykorzystaniem funkcji \texttt{mutate()} oraz \texttt{if\_else()}. Funkcja \texttt{if\_else()} przyjmuje trzy argumenty - pierwszy (\texttt{condition\ =}) to warunek, który jest weryfikowany, następnie podajemy wartość, która ma być wprowadzona w przypadku spełnienia warunku (\texttt{true\ =}), a na końcu wartość dla niespełnionego warunku (\texttt{false\ =}). Jest to odpowiednik funkcji \texttt{JEŻELI} z Excela.

W omawianym przykładzie warunkiem jest sprawdzenie czy wartości zmiennej \texttt{wykszt} są równe \texttt{NA}. Jeśli tak to na ich miejsce wprowadzany jest tekst \emph{nieustalone}, a w przeciwnym przypadku pozostaje oryginalna wartość.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{wykszt=}\FunctionTok{if\_else}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(wykszt), }\StringTok{"nieustalone"}\NormalTok{, wykszt)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(wykszt) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
## # Groups:   wykszt [4]
##   wykszt          n
##   <chr>       <int>
## 1 nieustalone  1857
## 2 podstawowe   6851
## 3 srednie     23202
## 4 wyzsze      13301
\end{verbatim}

\hypertarget{sortowanie}{%
\section{Sortowanie}\label{sortowanie}}

Sortowanie jest możliwe z wykorzystaniem funkcji \texttt{arrange()}. Jako argument podajemy zmienną według, której chcemy posortować zbiór. Domyślne zbiór sortowany jest rosnąco - od wartości najmniejszych do największych:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank\_sort }\OtherTok{\textless{}{-}}\NormalTok{ bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(saldo)}
\end{Highlighting}
\end{Shaded}

Zmiana kierunku sortowania jest możliwa po zastosowaniu funkcji \texttt{desc()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank\_sort }\OtherTok{\textless{}{-}}\NormalTok{ bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(saldo))}
\end{Highlighting}
\end{Shaded}

Sortowanie możemy także zastosować do wyników podsumowania danych:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(wykszt) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{liczebnosc=}\FunctionTok{n}\NormalTok{(),}
            \AttributeTok{saldo\_srednia=}\FunctionTok{mean}\NormalTok{(saldo),}
            \AttributeTok{saldo\_mediana=}\FunctionTok{median}\NormalTok{(saldo)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(saldo\_srednia)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 4
##   wykszt     liczebnosc saldo_srednia saldo_mediana
##   <chr>           <int>         <dbl>         <dbl>
## 1 srednie         23202         1155.           392
## 2 podstawowe       6851         1251.           403
## 3 <NA>             1857         1527.           568
## 4 wyzsze          13301         1758.           577
\end{verbatim}

\hypertarget{ux142ux105czenie-zbioruxf3w}{%
\section{Łączenie zbiorów}\label{ux142ux105czenie-zbioruxf3w}}

W celu zaprezentowania funkcji łączących dane przygotujemy kilka zbiorów pomocniczych:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{praca\_czas }\OtherTok{\textless{}{-}}\NormalTok{ bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(praca) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{sr\_czas=}\FunctionTok{mean}\NormalTok{(czas))}

\NormalTok{praca\_saldo }\OtherTok{\textless{}{-}}\NormalTok{ bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(praca) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{sr\_saldo=}\FunctionTok{mean}\NormalTok{(saldo))}

\NormalTok{zawod\_saldo }\OtherTok{\textless{}{-}}\NormalTok{ bank }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{zawod=}\NormalTok{praca) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(zawod) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{sr\_saldo=}\FunctionTok{mean}\NormalTok{(saldo))}
\end{Highlighting}
\end{Shaded}

Do łączenia dwóch zbiorów danych służy funkcja \texttt{inner\_join()}, która jako argumenty przyjmuje nazwy zbiorów danych oraz klucz łączenia. Jeśli w obu zbiorach występują kolumny o takich samych nazwach to zostaną potraktowane jako klucz łączenia:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{praca\_czas\_saldo }\OtherTok{\textless{}{-}} \FunctionTok{inner\_join}\NormalTok{(praca\_czas, praca\_saldo)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Joining, by = "praca"
\end{verbatim}

Jeśli takie kolumny nie będą istniały to wywołanie funkcji zwróci błąd:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{praca\_czas\_saldo }\OtherTok{\textless{}{-}} \FunctionTok{inner\_join}\NormalTok{(praca\_czas, zawod\_saldo)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Error: `by` must be supplied when `x` and `y` have no common variables.
## i use by = character()` to perform a cross-join.
\end{verbatim}

W takich przypadku należy wskazać klucz połączenia w postaci \texttt{by\ =\ c("id1"="id2")}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{praca\_czas\_saldo }\OtherTok{\textless{}{-}} \FunctionTok{inner\_join}\NormalTok{(praca\_czas, zawod\_saldo, }\AttributeTok{by=}\FunctionTok{c}\NormalTok{(}\StringTok{"praca"}\OtherTok{=}\StringTok{"zawod"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Jeśli w jednym ze zbiorów nie ma wszystkich identyfikatorów, które znajdują się w drugim zbiorze to zastosowanie funkcji \texttt{inner\_join()} będzie skutkowało zbiorem, w którym znajdą się tylko te obserwacje, które udało się połączyć.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{praca\_saldo\_1500 }\OtherTok{\textless{}{-}}\NormalTok{ praca\_saldo }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(sr\_saldo }\SpecialCharTok{\textgreater{}} \DecValTok{1500}\NormalTok{)}

\FunctionTok{inner\_join}\NormalTok{(praca\_czas, praca\_saldo\_1500, }\AttributeTok{by=}\StringTok{"praca"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 3
##   praca sr_czas sr_saldo
##   <dbl>   <dbl>    <dbl>
## 1     2    289.    1522.
## 2     3    254.    1764.
## 3     5    256.    1521.
## 4     7    268.    1648.
## 5     8    287.    1984.
## 6    NA    238.    1772.
\end{verbatim}

Jeśli chcemy pozostawić niedopasowane obserwacje to należy wykorzystać jedną z funkcji - \texttt{left\_join()} lub \texttt{right\_join()} w zależności od tego dla którego zbioru chcemy pozostawić wszystkie informacje.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{left\_join}\NormalTok{(praca\_czas, praca\_saldo\_1500, }\AttributeTok{by=}\StringTok{"praca"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 11 x 3
##    praca sr_czas sr_saldo
##    <dbl>   <dbl>    <dbl>
##  1     1    247.      NA 
##  2     2    289.    1522.
##  3     3    254.    1764.
##  4     4    246.      NA 
##  5     5    256.    1521.
##  6     6    263.      NA 
##  7     7    268.    1648.
##  8     8    287.    1984.
##  9     9    253.      NA 
## 10    10    257.      NA 
## 11    NA    238.    1772.
\end{verbatim}

\hypertarget{szeroka-i-wux105ska-reprezentacja-danych}{%
\section{Szeroka i wąska reprezentacja danych}\label{szeroka-i-wux105ska-reprezentacja-danych}}

Do wyjaśnienia kwestii szerokiej i wąskiej reprezentacji danych posłużymy się danymi z GUS dotyczącymi przeciętnego miesięcznego spożycie wybranych artykułów żywnościowych na 1 osobę w 2016 roku - \href{data/spozycie.xlsx}{plik}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{spozycie }\OtherTok{\textless{}{-}} \FunctionTok{read\_xlsx}\NormalTok{(}\StringTok{"data/spozycie.xlsx"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Taka tabela jest przykładem szerokiej reprezentacji danych. Z kolei w niektórych sytuacjach wygodnie jest korzystać z wąskiej reprezentacji danych, a niektóre pakiety wręcz wymagają takich zbiorów wejściowych.

Do transformacji danych z reprezentacji szerokiej na wąską służy funkcja \texttt{gather()} (pol. \emph{gromadzić}). Kluczowe są w niej dwa argumenty - pierwszy (\texttt{key}) określa nazwę nowej kolumny, która będzie zawierała nazwy zmiennych, a drugi (\texttt{value}) określa nazwę nowej kolumny, która będzie zawierała wartości zmiennych. Jako kolejne argumenty podaje się nazwy kolumn, które mają być transformowane lub nazwy kolumn ze znakiem minus \texttt{-}, które nie mają być transformowane.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{spozycie\_waskie }\OtherTok{\textless{}{-}}\NormalTok{ spozycie }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{gather}\NormalTok{(artykul, spozycie, mieso, owoce, warzywa)}

\CommentTok{\# spozycie\_waskie \textless{}{-} spozycie \%\textgreater{}\%}
\CommentTok{\#   gather(artykul, spozycie, {-}kod, {-}nazwa)}
\end{Highlighting}
\end{Shaded}

W takiej formie łatwiej podsumować dane:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{spozycie\_waskie }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(artykul) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{sr\_spozycie=}\FunctionTok{mean}\NormalTok{(spozycie))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   artykul sr_spozycie
##   <chr>         <dbl>
## 1 mieso          5.47
## 2 owoce          3.65
## 3 warzywa        8.85
\end{verbatim}

W porównaniu do szerokiej reprezentacji danych:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{spozycie }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{sr\_spozycie\_mieso=}\FunctionTok{mean}\NormalTok{(mieso),}
            \AttributeTok{sr\_spozycie\_owoce=}\FunctionTok{mean}\NormalTok{(owoce),}
            \AttributeTok{sr\_spozycie\_warzywa=}\FunctionTok{mean}\NormalTok{(warzywa))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1 x 3
##   sr_spozycie_mieso sr_spozycie_owoce sr_spozycie_warzywa
##               <dbl>             <dbl>               <dbl>
## 1              5.47              3.65                8.85
\end{verbatim}

Transformacja z wąskiej do szerokiej reprezentacji danych jest możliwa z zastosowaniem funkcji \texttt{spread()} (pol. \emph{rozprzestrzeniać}). W przypadku tej funkcji niezbędne są dwa argumenty - pierwszy (\texttt{key}) wskazuje kolumnę zawierającą nazwy dla nowych zmiennych, a drugi argument (\texttt{value}) wskazuje kolumnę zawierającą wartości dla nowych zmiennych.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{spozycie\_szerokie }\OtherTok{\textless{}{-}}\NormalTok{ spozycie\_waskie }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{spread}\NormalTok{(artykul, spozycie)}
\end{Highlighting}
\end{Shaded}

\hypertarget{eksport-danych}{%
\section{Eksport danych}\label{eksport-danych}}

Zapis zbioru danych do zewnętrznego pliku jest możliwy z wykorzystaniem funkcji \texttt{write.table()}. Jako argumenty tej funkcji określamy: zbiór danych (\texttt{x}), docelowe miejsce na dysku i nazwę pliku (\texttt{file}), separator kolumn (\texttt{sep}), separator miejsc dziesiętnych (\texttt{dec}) oraz argument \texttt{row.names\ =\ FALSE}, dzięki któremu unikniemy dodatkowych numerów wierszy.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write.table}\NormalTok{(spozycie\_waskie, }\AttributeTok{file =} \StringTok{"data/spozycie\_w.csv"}\NormalTok{, }\AttributeTok{sep=}\StringTok{";"}\NormalTok{, }\AttributeTok{dec=}\StringTok{","}\NormalTok{, }\AttributeTok{row.names=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

Taki plik jest plikiem csv, który możemy otworzyć w Excelu i zapisać go z rozszerzeniem .xlsx. Teoretycznie istnieje pakiet \texttt{xlsx}, który umożliwia zapisywanie zbiorów od razu do Excela, ale działa w oparciu o Javę, co bywa problematyczne.

\hypertarget{zadania-2}{%
\section{Zadania}\label{zadania-2}}

Na podstawie zbioru rossmann odpowiedź na pytania:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Ile było sklepów o asortymencie rozszerzonym w dniu 25-02-2014?
\item
  W jaki dzień tygodnia średnia liczba klientów była największa w sklepie nr 101?
\item
  Sklep jakiego typu charakteryzuje się największą medianą sprzedaży?
\item
  Czy w ciągu roku odległość do najbliższego sklepu konkurencji zmieniła się dla jakiegokolwiek sklepu Rossmann?
\end{enumerate}

\hypertarget{case-study}{%
\section{Case study}\label{case-study}}

Rozważmy sklepy Rossmann, które w 2014 roku były otwarte powyżej 300 dni w roku. Czy średnia sprzedaż wyrażona w zł w sklepach Rossmann różni się statystycznie pomiędzy grupami zdefiniowanymi przez asortyment sklepu? Dane na temat średniego kursu miesięcznego euro pobierz ze stron \href{http://www.nbp.pl/home.aspx?f=/kursy/arch_a.html}{NBP}.

\hypertarget{wizualizacja-danych}{%
\chapter{Wizualizacja danych}\label{wizualizacja-danych}}

\href{presentations/04_wizualizacja.html}{Prezentacja}

\hypertarget{wprowadzenie-2}{%
\section{Wprowadzenie}\label{wprowadzenie-2}}

\href{https://www.data-to-viz.com/}{Przewodnik po wizualizacji danych}

\href{https://serialmentor.com/dataviz/}{Fundamentals of Data Visualization}

Będziemy działać na zbiorze dotyczącym sprzedaży w sklepach: \href{http://wawrowski.edu.pl/data/rossmann.xlsx}{rossmann.xlsx} i \href{http://wawrowski.edu.pl/data/rossmann.RData}{rossmann.RData}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}

\CommentTok{\# library(readxl)}
\CommentTok{\# }
\CommentTok{\# rossmann \textless{}{-} read\_xlsx("data/rossmann.xlsx")}
\CommentTok{\#}
\CommentTok{\# save(rossmann, file="data/rossmann.RData")}

\CommentTok{\# natywny format, mniejszy rozmiar, szybsze wczytywanie}
\FunctionTok{load}\NormalTok{(}\StringTok{"data/rossmann.RData"}\NormalTok{)}

\NormalTok{sklep77 }\OtherTok{\textless{}{-}}\NormalTok{ rossmann }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(sklep\_id}\SpecialCharTok{==}\DecValTok{77}\NormalTok{, czy\_otwarty}\SpecialCharTok{==}\StringTok{"Tak"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Do prostych wykresów można wykorzystać wbudowaną funkcję \texttt{plot}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(sklep77}\SpecialCharTok{$}\NormalTok{sprzedaz, sklep77}\SpecialCharTok{$}\NormalTok{liczba\_klientow, }
     \AttributeTok{xlab =} \StringTok{"Sprzedaż"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Liczba klientów"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Sprzedaż i liczba klientów w sklepie Rossmann nr 77"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-131-1.pdf}

Jej możliwości są jednak ograniczone i stworzenie bardziej zaawansowanych grafik będzie wymagające.

Wiodącym pakietem do wizualizacji danych w R jest ggplot2:

\begin{itemize}
\tightlist
\item
  dokumentacja: \url{https://ggplot2.tidyverse.org/}
\item
  \href{https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf}{cheatsheet}
\item
  tworzenie wykresów poprzez dodawanie (\texttt{+}) kolejnych warstw
\end{itemize}

\hypertarget{wykres-punktowy}{%
\section{Wykres punktowy}\label{wykres-punktowy}}

Ten sam wykres co wcześniej, ale z wykorzystaniem pakietu ggplot2.

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-132-1.pdf}

Wykonanie krok po kroku:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Utworzenie siatki - określenie co chcemy na wykresie przedstawić
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-133-1.pdf}

W zależności od typu wykresu w funkcji \texttt{aes} mogą znaleźć się argumenty:

\begin{itemize}
\tightlist
\item
  x
\item
  y
\item
  fill
\item
  size
\item
  color
\item
  shape
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Określenie w jaki sposób chcemy te dane przedstawić - funkcja zawsze zaczyna się od \texttt{geom\_}:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-134-1.pdf}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Edytowanie etykiet osi - funkcje \texttt{xlab} i \texttt{ylab}:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Sprzedaż"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Liczba klientów"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-135-1.pdf}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Dodanie tytułu - funkcja \texttt{ggtitle}
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Sprzedaż"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Liczba klientów"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Sprzedaż i liczba klientów w sklepie Rossmann nr 77"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-136-1.pdf}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Zmiana motywu - funkcja rozpoczynająca się od \texttt{theme\_}:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Sprzedaż"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Liczba klientów"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Sprzedaż i liczba klientów w sklepie Rossmann nr 77"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_light}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-137-1.pdf}

Dostępne motywy:

\begin{itemize}
\tightlist
\item
  theme\_bw
\item
  theme\_classic
\item
  theme\_dark
\item
  theme\_gray
\item
  theme\_light
\item
  theme\_linedraw
\item
  theme\_minimal
\item
  theme\_void
\end{itemize}

Powyższe motywy są zaimplementowane w pakiecie ggplot2, ale można także skorzystać z dodatkowych pakietów:

\begin{itemize}
\tightlist
\item
  \href{https://github.com/bbc/bbplot}{theme\_bbc}
\item
  \href{https://cran.r-project.org/web/packages/xkcd/}{theme\_xkcd}
\end{itemize}

Albo stworzyć \href{https://www.statworx.com/de/blog/custom-themes-in-ggplot2/}{swój własny motyw}.

\emph{Zadanie}

Zmień motyw wykresu na wybrany przez siebie.

Dodamy teraz do wykresu kolejną cechę - rozpoczęcie promocji, żeby sprawdzić czy istnieje jakaś tendencja.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow, }\AttributeTok{color=}\NormalTok{czy\_promocja)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Sprzedaż"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Liczba klientów"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Sprzedaż i liczba klientów w sklepie Rossmann nr 77"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_light}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-138-1.pdf}

Okazuje się dosyć interesująco, niemniej nazwa etykiety legendy nie wygląda zbyt dobrze. Żeby to poprawić musimy użyć funkcji \texttt{scale\_}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow, }\AttributeTok{color=}\NormalTok{czy\_promocja)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Sprzedaż"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Liczba klientów"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_discrete}\NormalTok{(}\AttributeTok{name =} \StringTok{"Promocja"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Sprzedaż i liczba klientów w sklepie Rossmann nr 77"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_light}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-139-1.pdf}

W funkcji \texttt{scale\_} musimy podać w jaki sposób daną cechę wizualizujemy (x/y/color/\ldots) oraz jakiego jest typu. Oprócz nazwy w tej funkcji możemy określić wiele innych kwestii takich jak:

\begin{itemize}
\tightlist
\item
  wyświetlane etykiety
\item
  początek i koniec osi
\item
  kolory wariantów
\item
  etykiety wariantów
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow, }\AttributeTok{color=}\NormalTok{czy\_promocja)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Sprzedaż"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Liczba klientów"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_discrete}\NormalTok{(}\AttributeTok{name =} \StringTok{"Promocja"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Sprzedaż i liczba klientów w sklepie Rossmann nr 77"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_light}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-140-1.pdf}

Zmiana pozycji legendy możliwa jest z wykorzystaniem funkcji \texttt{theme}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow, }\AttributeTok{color=}\NormalTok{czy\_promocja)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Sprzedaż"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Liczba klientów"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_discrete}\NormalTok{(}\AttributeTok{name =} \StringTok{"Promocja"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Sprzedaż i liczba klientów w sklepie Rossmann nr 77"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_light}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-141-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow, }\AttributeTok{color=}\NormalTok{czy\_promocja)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Sprzedaż"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Liczba klientów"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_discrete}\NormalTok{(}\AttributeTok{name =} \StringTok{"Promocja"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Sprzedaż i liczba klientów w sklepie Rossmann nr 77"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_light}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula 'y ~ x'
\end{verbatim}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-142-1.pdf}

\hypertarget{histogram}{%
\section{Histogram}\label{histogram}}

Rozkład cechy można ocenić na podstawie histogramu - domyślnie rysowanych jest 30 słupków.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-143-1.pdf}

W funkcji \texttt{geom\_histogram} można podać liczbę słupków (\texttt{bins}) albo ich szerokość (\texttt{binwidth}). Poniżej zastosowano słupki o szerokości 1000 euro.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{1000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-144-1.pdf}

Dodatkowo w tej funkcji można określić kwestie estetyczne - kolory obramowania i wypełnienia słupków.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{500}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"green"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-145-1.pdf}

Pełna lista nazw kolorów znajduje się \href{http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf}{tutaj}.

Z wykorzystaniem funkcji \texttt{scale\_} zmieniamy nazwy osi (\texttt{name}), granice (\texttt{limits}) oraz wskazania liczbowe (\texttt{breaks}). Te dwie ostatnie wartości musimy deklarować jako wektory z wykorzystaniem funkcji \texttt{c()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{500}\NormalTok{, }
                 \AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"green"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Sprzedaż"}\NormalTok{, }
                     \AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{4000}\NormalTok{,}\DecValTok{17000}\NormalTok{),}
                     \AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\DecValTok{5000}\NormalTok{, }\DecValTok{8000}\NormalTok{, }\DecValTok{11000}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Liczebność"}\NormalTok{,}
                     \AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{50}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (geom_bar).
\end{verbatim}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-146-1.pdf}

Można zaumatyzować proces dobierania wskazań liczbowych z wykorzystaniem funkcji \texttt{seq} opisanej szerzej w rozdziale 2.1.2.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{500}\NormalTok{, }
                 \AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"green"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Sprzedaż"}\NormalTok{, }
                     \AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{4000}\NormalTok{,}\DecValTok{17000}\NormalTok{),}
                     \AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{4000}\NormalTok{, }\DecValTok{17000}\NormalTok{, }\DecValTok{1500}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Liczebność"}\NormalTok{,}
                     \AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{50}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 2 rows containing missing values (geom_bar).
\end{verbatim}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-147-1.pdf}

\hypertarget{wykres-pudeux142kowy}{%
\section{Wykres pudełkowy}\label{wykres-pudeux142kowy}}

Wykres pudełkowy umożliwia porównywanie rozkładów cechy wg zmiennej grupującej. Wymogiem jest aby na osi \texttt{x} znajdowała się zmienna grupująca, a na osi \texttt{y} cecha analizowana.

Przeanalizujemy sprzedaż według kolejnych dni tygodnia.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{dzien\_tyg, }\AttributeTok{y=}\NormalTok{sprzedaz)) }\SpecialCharTok{+} \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Continuous x aesthetic -- did you forget aes(group=...)?
\end{verbatim}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-148-1.pdf}

Zdecydowanie nie jest wykres jakiego oczekiwaliśmy. Wynika to z faktu, że dzień tygodnia w zbiorze danych jest zapisany jako zmienna numeryczna, natomiast prawidłowym typem dla zmiennej grupującej jest typ tekstowy lub czynnik (faktor). Ten typ danych został szczegółowo opisany w części 2.3.

Dokonujemy zatem zamiany typu danych:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sklep77 }\OtherTok{\textless{}{-}}\NormalTok{ sklep77 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dzien\_tyg=}\FunctionTok{factor}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dzien\_tyg,}
                          \AttributeTok{levels =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{,}
                          \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Pon"}\NormalTok{, }\StringTok{"Wt"}\NormalTok{, }\StringTok{"Śr"}\NormalTok{, }\StringTok{"Czw"}\NormalTok{, }\StringTok{"Pt"}\NormalTok{, }\StringTok{"Sob"}\NormalTok{),}
                          \AttributeTok{ordered =} \ConstantTok{TRUE}\NormalTok{))}

\FunctionTok{ggplot}\NormalTok{(sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{dzien\_tyg, }\AttributeTok{y=}\NormalTok{sprzedaz)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-149-1.pdf}

Z tego wykresu można już odczytać, że najwyższa mediana sprzedaży występuje w poniedziałek, a najniższa w środę.

Jeżli kategorii jest dużo to można obrócić wykres z wykorzystaniem funkcji \texttt{coord\_flip}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{dzien\_tyg, }\AttributeTok{y=}\NormalTok{sprzedaz)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_flip}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-150-1.pdf}

Użycie tej funkcji powoduje wyłącznie obrócenie wykresu. Nazwy osi nie uległy zmianie pomimo, że zostały zamienione.
Odwrócimy jeszcze kolejność etykiet dnia tygodnia, tak aby na górze był poniedziałek.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{dzien\_tyg, }\AttributeTok{y=}\NormalTok{sprzedaz)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_flip}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{rev}\NormalTok{(}\FunctionTok{levels}\NormalTok{(sklep77}\SpecialCharTok{$}\NormalTok{dzien\_tyg)))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-151-1.pdf}

\hypertarget{wykres-sux142upkowy}{%
\section{Wykres słupkowy}\label{wykres-sux142upkowy}}

W zależności od typu danych wejściowych, wykres słupkowy można stworzyć na dwa sposoby:

\begin{itemize}
\tightlist
\item
  dane jednostkowe - \texttt{geom\_bar} - funkcja sama oblicza wartości do wyświetlenia,
\item
  dane zagregowane - \texttt{geom\_col} - funkcja otrzymuje już obliczone wartości.
\end{itemize}

Sprawdźmy ile jest sklepów o danym asortymencie. W tym celu potrzebujemy informację o sklepie i typie oferowanego asortymentu.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rossmann\_asort }\OtherTok{\textless{}{-}}\NormalTok{ rossmann }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(sklep\_id, sklep\_asort) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{distinct}\NormalTok{()}

\FunctionTok{glimpse}\NormalTok{(rossmann\_asort)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 1,115
## Columns: 2
## $ sklep_id    <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18,~
## $ sklep_asort <chr> "Podstawowy", "Podstawowy", "Podstawowy", "Rozszerzony", "~
\end{verbatim}

W funkcji \texttt{aes} podajemy tylko kolumnę zawierającą dane do zliczenia.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(rossmann\_asort, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sklep\_asort)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-153-1.pdf}

Natomiast użycie funkcji \texttt{geom\_col} wymaga samodzielnego obliczenia wartości:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rossmann\_asort2 }\OtherTok{\textless{}{-}}\NormalTok{ rossmann\_asort }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(sklep\_asort)}

\FunctionTok{glimpse}\NormalTok{(rossmann\_asort2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 3
## Columns: 2
## $ sklep_asort <chr> "Extra", "Podstawowy", "Rozszerzony"
## $ n           <int> 9, 593, 513
\end{verbatim}

Wartość do wyświetlenia podajemy w funkcji \texttt{aes} w argumencie \texttt{y}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(rossmann\_asort2, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sklep\_asort, }\AttributeTok{y=}\NormalTok{n)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-155-1.pdf}

Uporządkujemy etykiety osi \texttt{x} (obecnie są wyświetlane w kolejności alfabetycznej) tworząc czynnik.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rossmann\_asort2 }\OtherTok{\textless{}{-}}\NormalTok{ rossmann\_asort2 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{sklep\_asort=}\FunctionTok{factor}\NormalTok{(}\AttributeTok{x =}\NormalTok{ sklep\_asort,}
                            \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Podstawowy"}\NormalTok{, }
                                       \StringTok{"Rozszerzony"}\NormalTok{, }
                                       \StringTok{"Extra"}\NormalTok{), }
                            \AttributeTok{ordered =}\NormalTok{ T))}

\FunctionTok{glimpse}\NormalTok{(rossmann\_asort2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 3
## Columns: 2
## $ sklep_asort <ord> Extra, Podstawowy, Rozszerzony
## $ n           <int> 9, 593, 513
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(rossmann\_asort2, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sklep\_asort, }\AttributeTok{y=}\NormalTok{n)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-157-1.pdf}

Do wykresu słupkowego możemy dodać jeszcze jedną zmienną. W tym przypadku będzie to typ sklepu.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rossmann\_asort3 }\OtherTok{\textless{}{-}}\NormalTok{ rossmann }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(sklep\_id, sklep\_asort, sklep\_typ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{distinct}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(sklep\_asort, sklep\_typ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{sklep\_asort=}\FunctionTok{factor}\NormalTok{(}\AttributeTok{x =}\NormalTok{ sklep\_asort,}
                            \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Podstawowy"}\NormalTok{, }
                                       \StringTok{"Rozszerzony"}\NormalTok{, }
                                       \StringTok{"Extra"}\NormalTok{), }
                            \AttributeTok{ordered =}\NormalTok{ T))}

\FunctionTok{glimpse}\NormalTok{(rossmann\_asort3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 9
## Columns: 3
## $ sklep_asort <ord> Extra, Podstawowy, Podstawowy, Podstawowy, Podstawowy, Roz~
## $ sklep_typ   <chr> "b", "a", "b", "c", "d", "a", "b", "c", "d"
## $ n           <int> 9, 381, 7, 77, 128, 221, 1, 71, 220
\end{verbatim}

Uwzględnienie kolejnej zmiennej jest możliwe jako argument \texttt{fill} w funkcji \texttt{aes}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(rossmann\_asort3, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sklep\_asort, }\AttributeTok{y=}\NormalTok{n, }\AttributeTok{fill=}\NormalTok{sklep\_typ)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-159-1.pdf}

Domyślnie kategorie są układane jedna na drugą - \texttt{stack}. Można je ułożyć obok siebie dodając argument \texttt{position\ =\ "dodge"} w funkcji \texttt{geom\_col}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(rossmann\_asort3, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sklep\_asort, }\AttributeTok{y=}\NormalTok{n, }\AttributeTok{fill=}\NormalTok{sklep\_typ)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-160-1.pdf}

Możemy jeszcze dodać etykiety słupków wykorzystując funkcję \texttt{geom\_text}, w której trzeba podać argumenty definujące położenie wartości etykiet. Wartości tych argumentów będą zależały od typu wykresu.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(rossmann\_asort3, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sklep\_asort, }\AttributeTok{y=}\NormalTok{n, }\AttributeTok{fill=}\NormalTok{sklep\_typ)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ n), }
            \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.9}\NormalTok{),}
            \AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-161-1.pdf}

Zmienimy jeszcze nazwę legendy za pomocą funkcji \texttt{scale\_fill\_discrete}. Wykorzystujemy tę konkretną funkcję ze względu na to, że typ sklepu jest argumentem \texttt{fill} w funkcji \texttt{aes} oraz cechą jakościową (\texttt{discrete}).

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(rossmann\_asort3, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sklep\_asort, }\AttributeTok{y=}\NormalTok{n, }\AttributeTok{fill=}\NormalTok{sklep\_typ)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ n), }
            \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.9}\NormalTok{),}
            \AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_discrete}\NormalTok{(}\AttributeTok{name =} \StringTok{"Typ sklepu"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-162-1.pdf}

\hypertarget{wykres-kafelkowy}{%
\section{Wykres kafelkowy}\label{wykres-kafelkowy}}

Do wizualizacji tabeli częstości można użyć wykresu kafelkowego. W tym celu najpierw zliczamy wystąpienia wariantów cech czy\_promocja oraz czy\_swieto\_szkolne i wynik przekazujemy bezpośrednio do funkcji \texttt{ggplot()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sklep77 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(czy\_promocja, czy\_swieto\_szkolne) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ czy\_promocja, }
             \AttributeTok{y =}\NormalTok{ czy\_swieto\_szkolne,}
             \AttributeTok{fill =}\NormalTok{ n)) }\SpecialCharTok{+}
  \FunctionTok{geom\_tile}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-163-1.pdf}

Aby dodać do tego wykresu etykiety posłużymy się funkcją \texttt{geom\_label()}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sklep77 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(czy\_promocja, czy\_swieto\_szkolne) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ czy\_promocja, }
             \AttributeTok{y =}\NormalTok{ czy\_swieto\_szkolne,}
             \AttributeTok{fill =}\NormalTok{ n)) }\SpecialCharTok{+}
  \FunctionTok{geom\_tile}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_label}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ n), }\AttributeTok{color =} \StringTok{"white"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-164-1.pdf}

Zwykle patrząc na wykres podświadomie zakładamy, że ciemniejszy kolor oznacza wyższe wartości, natomiast jasny małe liczby. W tym przypadku układ kolorów jest odwrócony. Musimy odpowiednio dobrać kolory, aby to poprawić. Bardzo przydatne narzędzie znajduje się pod adresem: \url{http://colorbrewer2.org/}. Następnie korzystamy z funkcji \texttt{scale\_fill\_gradient}, w której określamy tylko kolor początkowy i końcowy.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sklep77 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{(czy\_promocja, czy\_swieto\_szkolne) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(., }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ czy\_promocja, }
                \AttributeTok{y =}\NormalTok{ czy\_swieto\_szkolne,}
                \AttributeTok{fill =}\NormalTok{ n)) }\SpecialCharTok{+}
  \FunctionTok{geom\_tile}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_label}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ n), }\AttributeTok{color =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_gradient}\NormalTok{(}\AttributeTok{low =} \StringTok{"\#66c2a4"}\NormalTok{, }
                      \AttributeTok{high =} \StringTok{"\#005824"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-165-1.pdf}

\hypertarget{uwzglux119dnienie-czasu}{%
\section{Uwzględnienie czasu}\label{uwzglux119dnienie-czasu}}

Próba stworzenia wykresu przedstawiającego zmianę sprzedaży w czasie za pomocą oryginalnych danych spowoduje uzsykanie niezbyt czytelnej grafiki.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{data,}
                    \AttributeTok{y=}\NormalTok{sprzedaz,}
                    \AttributeTok{color=}\NormalTok{dzien\_tyg)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-166-1.pdf}

Wynika to z faktu, że dzien tygodnia jest traktowany jak zmienna numeryczna, a data jest zmienną tekstową. Konwersja tekstu na datę jest możliwa z wykorzystaniem pakietu \texttt{lubridate}. W tym pakiecie każda część daty ma swój akronim, który później jest wykorzystywany w odpowiednich funkcjach:

\begin{itemize}
\tightlist
\item
  y - rok (year)
\item
  m - miesiąc (month)
\item
  d - dzień (day)
\item
  h - godzina (hour)
\item
  m - minuta (minute)
\end{itemize}

Przykłady funkcji:

\begin{itemize}
\tightlist
\item
  ymd - konwertuje tekst zapisany w postaci rok-miesiąc-dzień na obiekt daty
\item
  dmy\_hm - konwertuje tekst zapisany w postaci dzień-miesiąc-rok godzina:minuta na obiekt daty
\item
  month - pobiera z obiektu daty informację o miesiącu
\item
  year - pobiera z obiektu daty informację o roku
\item
  week - pobiera z obiektu daty informację o tygodniu roku
\end{itemize}

Według powyższych reguł korzystamy z funkcji \texttt{ymd()} do konwersji daty w naszym zbiorze.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lubridate)}

\NormalTok{sklep77a }\OtherTok{\textless{}{-}}\NormalTok{ sklep77 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dzien\_tyg=}\FunctionTok{as.factor}\NormalTok{(dzien\_tyg),}
         \AttributeTok{data=}\FunctionTok{ymd}\NormalTok{(data))}

\FunctionTok{ggplot}\NormalTok{(sklep77a, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{data,}
                    \AttributeTok{y=}\NormalTok{sprzedaz,}
                    \AttributeTok{color=}\NormalTok{dzien\_tyg)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-167-1.pdf}

\hypertarget{facets}{%
\section{Facets}\label{facets}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sr\_sprzedaz }\OtherTok{\textless{}{-}}\NormalTok{ rossmann }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(sprzedaz }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(sklep\_id, sklep\_asort) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{sprzedaz\_sr=}\FunctionTok{mean}\NormalTok{(sprzedaz))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'sklep_id'. You can override using the `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{odleglosc }\OtherTok{\textless{}{-}}\NormalTok{ rossmann }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(sklep\_id, sklep\_konkurencja) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{distinct}\NormalTok{()}

\NormalTok{sprzedaz\_odleglosc }\OtherTok{\textless{}{-}} \FunctionTok{inner\_join}\NormalTok{(sr\_sprzedaz, odleglosc, }\AttributeTok{by=}\StringTok{"sklep\_id"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(sprzedaz\_odleglosc, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz\_sr, }\AttributeTok{y=}\NormalTok{sklep\_konkurencja)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ sklep\_asort)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 3 rows containing missing values (geom_point).
\end{verbatim}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-168-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sr\_sprzedaz\_prom }\OtherTok{\textless{}{-}}\NormalTok{ rossmann }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(sprzedaz }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(sklep\_id, czy\_promocja) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{sprzedaz\_sr=}\FunctionTok{mean}\NormalTok{(sprzedaz))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'sklep_id'. You can override using the `.groups` argument.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sprzedaz\_prom\_odl }\OtherTok{\textless{}{-}} \FunctionTok{inner\_join}\NormalTok{(sr\_sprzedaz\_prom, odleglosc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Joining, by = "sklep_id"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(sprzedaz\_prom\_odl)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 4
## # Groups:   sklep_id [3]
##   sklep_id czy_promocja sprzedaz_sr sklep_konkurencja
##      <dbl> <chr>              <dbl>             <dbl>
## 1        1 Nie                4288.              1270
## 2        1 Tak                5274.              1270
## 3        2 Nie                3902.               570
## 4        2 Tak                6295.               570
## 5        3 Nie                5286.             14130
## 6        3 Tak                8790.             14130
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(sprzedaz\_prom\_odl, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz\_sr, }\AttributeTok{y=}\NormalTok{sklep\_konkurencja, }\AttributeTok{color=}\NormalTok{czy\_promocja)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 6 rows containing missing values (geom_point).
\end{verbatim}

\includegraphics{Wawrowski_PPR_files/figure-latex/unnamed-chunk-169-1.pdf}

Zamiana reprezentacji danych na szeroką.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sprzedaz\_prom\_odl\_wide }\OtherTok{\textless{}{-}}\NormalTok{ sprzedaz\_prom\_odl }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{spread}\NormalTok{(czy\_promocja, sprzedaz\_sr)}

\FunctionTok{head}\NormalTok{(sprzedaz\_prom\_odl\_wide)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 4
## # Groups:   sklep_id [6]
##   sklep_id sklep_konkurencja   Nie    Tak
##      <dbl>             <dbl> <dbl>  <dbl>
## 1        1              1270 4288.  5274.
## 2        2               570 3902.  6295.
## 3        3             14130 5286.  8790.
## 4        4               620 9030. 10686.
## 5        5             29910 3473.  6084.
## 6        6               310 4189.  6295.
\end{verbatim}

I na wąską.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sprzedaz\_prom\_odl\_long }\OtherTok{\textless{}{-}}\NormalTok{ sprzedaz\_prom\_odl\_wide }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{gather}\NormalTok{(czy\_promocja, sprzedaz\_sr, Nie, Tak)}

\FunctionTok{head}\NormalTok{(sprzedaz\_prom\_odl\_long)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 4
## # Groups:   sklep_id [6]
##   sklep_id sklep_konkurencja czy_promocja sprzedaz_sr
##      <dbl>             <dbl> <chr>              <dbl>
## 1        1              1270 Nie                4288.
## 2        2               570 Nie                3902.
## 3        3             14130 Nie                5286.
## 4        4               620 Nie                9030.
## 5        5             29910 Nie                3473.
## 6        6               310 Nie                4189.
\end{verbatim}

\hypertarget{wykres-interaktywny}{%
\section{Wykres interaktywny}\label{wykres-interaktywny}}

Za pomocą pakietu \texttt{plotly} w prosty sposób można zamienić statystyczny wykres \texttt{ggplot} na interaktywny.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(plotly)}

\NormalTok{p }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sklep77, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{sprzedaz, }\AttributeTok{y=}\NormalTok{liczba\_klientow, }\AttributeTok{color=}\NormalTok{czy\_promocja)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Sprzedaż"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Liczba klientów"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_discrete}\NormalTok{(}\AttributeTok{name =} \StringTok{"Promocja"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Sprzedaż i liczba klientów w sklepie Rossmann nr 77"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_light}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{)}

\NormalTok{plotly}\SpecialCharTok{::}\FunctionTok{ggplotly}\NormalTok{(p)}
\end{Highlighting}
\end{Shaded}

\emph{Zadanie}

Stwórz trzy grafiki dla danych dotyczących \href{data/movies.csv}{filmów}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{filmy }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"data/movies.csv"}\NormalTok{)}

\FunctionTok{summary}\NormalTok{(filmy)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     title              genre             director              year     
##  Length:2961        Length:2961        Length:2961        Min.   :1920  
##  Class :character   Class :character   Class :character   1st Qu.:1999  
##  Mode  :character   Mode  :character   Mode  :character   Median :2004  
##                                                           Mean   :2003  
##                                                           3rd Qu.:2010  
##                                                           Max.   :2016  
##     duration         gross               budget          cast_facebook_likes
##  Min.   : 37.0   Min.   :      703   Min.   :      218   Min.   :     0     
##  1st Qu.: 95.0   1st Qu.: 12276810   1st Qu.: 11000000   1st Qu.:  2241     
##  Median :106.0   Median : 34703228   Median : 26000000   Median :  4604     
##  Mean   :109.6   Mean   : 58090401   Mean   : 40619384   Mean   : 12394     
##  3rd Qu.:119.0   3rd Qu.: 75590286   3rd Qu.: 55000000   3rd Qu.: 16926     
##  Max.   :330.0   Max.   :760505847   Max.   :300000000   Max.   :656730     
##      votes            reviews           rating     
##  Min.   :      5   Min.   :   2.0   Min.   :1.600  
##  1st Qu.:  19918   1st Qu.: 199.0   1st Qu.:5.800  
##  Median :  55749   Median : 364.0   Median :6.500  
##  Mean   : 109308   Mean   : 503.3   Mean   :6.389  
##  3rd Qu.: 133348   3rd Qu.: 631.0   3rd Qu.:7.100  
##  Max.   :1689764   Max.   :5312.0   Max.   :9.300
\end{verbatim}

Z racji mnogości gatunków można ograniczyć się do kilku wybranych.

\hypertarget{programowanie-w-r}{%
\chapter{Programowanie w R}\label{programowanie-w-r}}

\href{presentations/05_programowanie.html}{Prezentacja}

\hypertarget{instrukcje-warunkowe}{%
\section{Instrukcje warunkowe}\label{instrukcje-warunkowe}}

Za pomocą instrukcji if możemy warunkowo wykonywać kod. Ogólna postać jest następująca:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{(warunek)\{}
  \CommentTok{\# kod wykonany jeśli warunek jest równy TRUE}
\NormalTok{\} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{(warunek) \{}
  \CommentTok{\# kod wykonany jeśli warunek jest równy TRUE}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \CommentTok{\# kod wykonany jeśli warunek jest równy FALSE}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Element warunek musi zwracać wartość logiczną \texttt{TRUE} albo \texttt{FALSE}. Chcąć uwzględnić więcej niż jeden warunek należy wykorzystać odpowiedni operator łączenia:

\begin{itemize}
\tightlist
\item
  i : \&\&
\item
  lub : \textbar\textbar{}
\end{itemize}

\hypertarget{funkcje}{%
\section{Funkcje}\label{funkcje}}

Funkcję ograniczają potrzebę kopiowania kodu i ułatwiają wprowadzanie zmian.

Stworzenie funkcji wymaga:

\begin{itemize}
\tightlist
\item
  wymyślenia nazwy funkcji,
\item
  określenia elementów wejściowych,
\item
  umieszczenia kodu w ciele funkcji.
\end{itemize}

Istnieją pewne dobre praktyki tworzenia funkcji:

\begin{itemize}
\tightlist
\item
  nazwy funkcji powinny być czasownikami,
\item
  podkreślnik vs.~notacja camelCase i konsekwencja stosowania,
\item
  wspólny przedrostek np. rnorm, runif.
\end{itemize}

\hypertarget{pux119tle}{%
\section{Pętle}\label{pux119tle}}

Pętlę są wykorzystywane w sytuacji, w której chcemy powtórzyć wykonanie kodu.

\end{document}
